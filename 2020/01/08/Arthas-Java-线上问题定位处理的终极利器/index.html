<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://congsheng.wang').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="前言在使用 Arthas 之前，当遇到 Java 线上问题时，如 CPU 飙升、负载突高、内存溢出等问题，你需要查命令，查网络，然后 jps、jstack、jmap、jhat、jstat、hprof 等一通操作。最终焦头烂额，还不一定能查出问题所在。而现在，大多数的常见问题你都可以使用 Arthas 轻松定位，迅速解决，及时止损，准时下班。">
<meta name="keywords" content="Arthas">
<meta property="og:type" content="article">
<meta property="og:title" content="Arthas - Java 线上问题定位处理的终极利器">
<meta property="og:url" content="http:&#x2F;&#x2F;congsheng.wang&#x2F;2020&#x2F;01&#x2F;08&#x2F;Arthas-Java-%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E5%A4%84%E7%90%86%E7%9A%84%E7%BB%88%E6%9E%81%E5%88%A9%E5%99%A8&#x2F;index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="前言在使用 Arthas 之前，当遇到 Java 线上问题时，如 CPU 飙升、负载突高、内存溢出等问题，你需要查命令，查网络，然后 jps、jstack、jmap、jhat、jstat、hprof 等一通操作。最终焦头烂额，还不一定能查出问题所在。而现在，大多数的常见问题你都可以使用 Arthas 轻松定位，迅速解决，及时止损，准时下班。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;521bd-1570979767404.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;938cc-image-20191106003512451.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;4f8f7-1570979937637.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;9e0b7-1571212470373.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;add7f-1570983440457.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;d4709-1570983401254.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;4977b-1570983061047.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;795d2-1571016675083.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;3ac1e-1571020871537.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;1b4bd-1571021838323.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;59db9-1571206638142.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;8818b-image-20191106012005747.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;c8ccb-1571196786678.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;62a2b-1571208153793.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;f139e-1571208245597.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;59e40-1571210158018.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;ea60d-1571196483469.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;6654e-1571210706602.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;1ef63-1571212007249.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;adc02-1571212080071.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;9edea-1571212151064.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;d76c1-1571212227058.png">
<meta property="og:updated_time" content="2020-01-08T07:35:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;11&#x2F;521bd-1570979767404.png">

<link rel="canonical" href="http://congsheng.wang/2020/01/08/Arthas-Java-%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E5%A4%84%E7%90%86%E7%9A%84%E7%BB%88%E6%9E%81%E5%88%A9%E5%99%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>Arthas - Java 线上问题定位处理的终极利器 | 个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">congsheng的博客</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">156</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">94</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">984</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://congsheng.wang/2020/01/08/Arthas-Java-%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E5%A4%84%E7%90%86%E7%9A%84%E7%BB%88%E6%9E%81%E5%88%A9%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="congsheng.wang">
      <meta itemprop="description" content="trouble is a friend">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Arthas - Java 线上问题定位处理的终极利器
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-08 15:35:50" itemprop="dateCreated datePublished" datetime="2020-01-08T15:35:50+08:00">2020-01-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">Java技术</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在使用 <strong>Arthas</strong> 之前，当遇到 Java 线上问题时，如 CPU 飙升、负载突高、内存溢出等问题，你需要查命令，查网络，然后 jps、jstack、jmap、jhat、jstat、hprof 等一通操作。最终焦头烂额，还不一定能查出问题所在。而现在，大多数的常见问题你都可以使用 <strong>Arthas</strong> 轻松定位，迅速解决，及时止损，准时下班。</p>
<a id="more"></a>

<h1 id="1、Arthas-介绍"><a href="#1、Arthas-介绍" class="headerlink" title="1、Arthas 介绍"></a>1、Arthas 介绍</h1><p><strong>Arthas</strong> 是 <code>Alibaba</code> 在 2018 年 9 月开源的 <strong>Java 诊断</strong>工具。支持 <code>JDK6+</code>， 采用命令行交互模式，提供 <code>Tab</code> 自动不全，可以方便的定位和诊断线上程序运行问题。截至本篇文章编写时，已经收获 <code>Star</code> 17000+。<br><strong>Arthas</strong> 官方文档十分详细，本文也参考了官方文档内容，同时在开源在的 <code>Github</code> 的项目里的 <code>Issues</code> 里不仅有问题反馈，更有大量的使用案例，也可以进行学习参考。<br>开源地址：<em><a href="https://github.com/alibaba/arthas" target="_blank" rel="noopener">https://github.com/alibaba/arthas</a></em><br>官方文档：<em><a href="https://alibaba.github.io/arthas" target="_blank" rel="noopener">https://alibaba.github.io/arthas</a></em></p>
<h1 id="2、Arthas-使用场景"><a href="#2、Arthas-使用场景" class="headerlink" title="2、Arthas 使用场景"></a>2、Arthas 使用场景</h1><p>得益于 <strong>Arthas</strong> 强大且丰富的功能，让 <strong>Arthas</strong> 能做的事情超乎想象。下面仅仅列举几项常见的使用情况，更多的使用场景可以在熟悉了 <strong>Arthas</strong> 之后自行探索。</p>
<ol>
<li>是否有一个全局视角来查看系统的运行状况？</li>
<li>为什么 CPU 又升高了，到底是哪里占用了 CPU ？</li>
<li>运行的多线程有死锁吗？有阻塞吗？</li>
<li>程序运行耗时很长，是哪里耗时比较长呢？如何监测呢？</li>
<li>这个类从哪个 jar 包加载的？为什么会报各种类相关的 Exception？</li>
<li>我改的代码为什么没有执行到？难道是我没 commit？分支搞错了？</li>
<li>遇到问题无法在线上 debug，难道只能通过加日志再重新发布吗？</li>
<li>有什么办法可以监控到 JVM 的实时运行状态？</li>
</ol>
<h1 id="3、Arthas-怎么用"><a href="#3、Arthas-怎么用" class="headerlink" title="3、Arthas 怎么用"></a>3、Arthas 怎么用</h1><p>前文已经提到，<strong>Arthas</strong> 是一款命令行交互模式的 Java 诊断工具，由于是 Java 编写，所以可以直接下载相应 的 jar 包运行。</p>
<h2 id="3-1-安装"><a href="#3-1-安装" class="headerlink" title="3.1 安装"></a>3.1 安装</h2><p>可以在官方 Github 上进行下载，如果速度较慢，可以尝试国内的码云 Gitee 下载。</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta"># github下载</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//alibaba.github.io/arthas/arthas-boot.jar</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="meta"># 或者 Gitee 下载</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//arthas.gitee.io/arthas-boot.jar</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="meta"># 打印帮助信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">java -jar arthas-boot.jar -h</span></pre></td></tr></table></figure>

<h2 id="3-2-运行"><a href="#3-2-运行" class="headerlink" title="3.2 运行"></a>3.2 运行</h2><p><strong>Arthas</strong> 只是一个 java 程序，所以可以直接用 <code>java -jar</code> 运行。运行时或者运行之后要选择要监测的 Java 进程。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"># 运行方式1，先运行，在选择 <span class="selector-tag">Java</span> 进程 <span class="selector-tag">PID</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">java</span> <span class="selector-tag">-jar</span> <span class="selector-tag">arthas-boot</span><span class="selector-class">.jar</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"># 选择进程(输入<span class="selector-attr">[]</span>内编号(不是<span class="selector-tag">PID</span>)回车)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[INFO]</span> <span class="selector-tag">arthas-boot</span> <span class="selector-tag">version</span>: 3<span class="selector-class">.1</span><span class="selector-class">.4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[INFO]</span> <span class="selector-tag">Found</span> <span class="selector-tag">existing</span> <span class="selector-tag">java</span> <span class="selector-tag">process</span>, <span class="selector-tag">please</span> <span class="selector-tag">choose</span> <span class="selector-tag">one</span> <span class="selector-tag">and</span> <span class="selector-tag">hit</span> <span class="selector-tag">RETURN</span>.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">* <span class="selector-attr">[1]</span>: 11616 <span class="selector-tag">com</span><span class="selector-class">.Arthas</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">  <span class="selector-attr">[2]</span>: 8676</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  <span class="selector-attr">[3]</span>: 16200 <span class="selector-tag">org</span><span class="selector-class">.jetbrains</span><span class="selector-class">.jps</span><span class="selector-class">.cmdline</span><span class="selector-class">.Launcher</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">  <span class="selector-attr">[4]</span>: 21032 <span class="selector-tag">org</span><span class="selector-class">.jetbrains</span><span class="selector-class">.idea</span><span class="selector-class">.maven</span><span class="selector-class">.server</span><span class="selector-class">.RemoteMavenServer</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"># 运行方式2，运行时选择 <span class="selector-tag">Java</span> 进程 <span class="selector-tag">PID</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">java</span> <span class="selector-tag">-jar</span> <span class="selector-tag">arthas-boot</span><span class="selector-class">.jar</span> <span class="selector-attr">[PID]</span></span></pre></td></tr></table></figure>

<p>查看 PID 的方式可以通过 <code>ps</code> 命令，也可以通过 JDK 提供的 <code>jps</code>命令。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看运行的 java 进程信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>jps -mlvV</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选 java 进程信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>jps -mlvV | grep [xxx]</span></pre></td></tr></table></figure>

<p><code>jps</code> 筛选想要的进程方式。<br><img src="http://image.winrains.cn/2019/11/521bd-1570979767404.png" alt="jps 筛选进程"><br>在出现 <strong>Arthas</strong> Logo 之后就可以使用命令进行问题诊断了。下面会详细介绍。<br><img src="http://image.winrains.cn/2019/11/938cc-image-20191106003512451.png" alt="Arthas 启动"><br>更多的启动方式可以参考 help 帮助命令。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 其他用法</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">EXAMPLES:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>&lt;pid&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--target-ip <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--telnet-port <span class="number">9999</span> --http-port -<span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--tunnel-server <span class="string">'ws://192.168.10.11:7777/ws'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--tunnel-server <span class="string">'ws://192.168.10.11:7777/ws'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">--agent-id <span class="keyword">bvDOe8XbTM2pQWjF4cfw</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword"> </span> <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--stat-url <span class="string">'http://192.168.10.11:8080/api/stat'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>-c <span class="string">'sysprop; thread'</span> &lt;pid&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>-f <span class="keyword">batch.as </span>&lt;pid&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--use-version <span class="number">3</span>.<span class="number">1</span>.<span class="number">4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--versions</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--session-timeout <span class="number">3600</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--attach-only</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">  <span class="keyword">java </span>-<span class="keyword">jar </span>arthas-<span class="keyword">boot.jar </span>--repo-mirror aliyun --use-http</span></pre></td></tr></table></figure>

<h2 id="3-3-web-console"><a href="#3-3-web-console" class="headerlink" title="3.3 web console"></a>3.3 web console</h2><p><strong>Arthas</strong> 目前支持 <code>Web Console</code>，在成功启动连接进程之后就已经自动启动，可以直接访问 <a href="http://127.0.0.1:8563/" target="_blank" rel="noopener">http://127.0.0.1:8563/</a> 访问，页面上的操作模式和控制台完全一样。<br><img src="http://image.winrains.cn/2019/11/4f8f7-1570979937637.png" alt="1570979937637"></p>
<h2 id="3-4-常用命令"><a href="#3-4-常用命令" class="headerlink" title="3.4 常用命令"></a>3.4 常用命令</h2><p>下面列举一些 <a href="https://www.codingme.net/2019/11/arthas/" target="_blank" rel="noopener"><strong>Arthas</strong></a> 的常用命令，看到这里你可能还不知道怎么使用，别急，后面会一一介绍。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>介绍</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://alibaba.github.io/arthas/dashboard.html" target="_blank" rel="noopener">dashboard</a></td>
<td>当前系统的实时数据面板</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/thread.html" target="_blank" rel="noopener"><strong>thread</strong></a></td>
<td>查看当前 JVM 的线程堆栈信息</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/watch.html" target="_blank" rel="noopener"><strong>watch</strong></a></td>
<td>方法执行数据观测</td>
</tr>
<tr>
<td><strong><a href="https://alibaba.github.io/arthas/trace.html" target="_blank" rel="noopener">trace</a></strong></td>
<td>方法内部调用路径，并输出方法路径上的每个节点上耗时</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/stack.html" target="_blank" rel="noopener"><strong>stack</strong></a></td>
<td>输出当前方法被调用的调用路径</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/tt.html" target="_blank" rel="noopener"><strong>tt</strong></a></td>
<td>方法执行数据的时空隧道，记录下指定方法每次调用的入参和返回信息，并能对这些不同的时间下调用进行观测</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/monitor.html" target="_blank" rel="noopener">monitor</a></td>
<td>方法执行监控</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/jvm.html" target="_blank" rel="noopener">jvm</a></td>
<td>查看当前 JVM 信息</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/vmoption.html" target="_blank" rel="noopener">vmoption</a></td>
<td>查看，更新 JVM 诊断相关的参数</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/sc.html" target="_blank" rel="noopener">sc</a></td>
<td>查看 JVM 已加载的类信息</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/sm.html" target="_blank" rel="noopener">sm</a></td>
<td>查看已加载类的方法信息</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/jad.html" target="_blank" rel="noopener">jad</a></td>
<td>反编译指定已加载类的源码</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/classloader.html" target="_blank" rel="noopener">classloader</a></td>
<td>查看 classloader 的继承树，urls，类加载信息</td>
</tr>
<tr>
<td><a href="https://alibaba.github.io/arthas/heapdump.html" target="_blank" rel="noopener">heapdump</a></td>
<td>类似 jmap 命令的 heap dump 功能</td>
</tr>
</tbody></table>
<h2 id="3-5-退出"><a href="#3-5-退出" class="headerlink" title="3.5 退出"></a>3.5 退出</h2><p>使用 shutdown 退出时 <strong>Arthas</strong> 同时自动重置所有增强过的类 。</p>
<h1 id="4、Arthas-常用操作"><a href="#4、Arthas-常用操作" class="headerlink" title="4、Arthas 常用操作"></a>4、Arthas 常用操作</h1><p>上面已经了解了什么是 <strong>Arthas</strong>，以及 <strong>Arthas</strong> 的启动方式，下面会依据一些情况，详细说一说 <strong>Arthas</strong> 的使用方式。在使用命令的过程中如果有问题，每个命令都可以是 <code>-h</code> 查看帮助信息。<br>首先编写一个有各种情况的测试类运行起来，再使用 <strong>Arthas</strong> 进行问题定位。</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashSet;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * &lt;p&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * Arthas Demo</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * 公众号：未读代码</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> *</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * @Author niujinpeng</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">@Slf4j</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Arthas</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    private static HashSet hashSet = <span class="keyword">new</span> HashSet();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">/** 线程池，大小1*/</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    private static ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">1</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    public static <span class="literal">void</span> main(String[] args) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        <span class="regexp">// 模拟 CPU 过高，这里注释掉了，测试时可以打开</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">        //</span> cpu();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        <span class="regexp">// 模拟线程阻塞</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">        thread();</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">        //</span> 模拟线程死锁</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        deadThread();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        <span class="regexp">// 不断的向 hashSet 集合增加数据</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">        addHashSetThread();</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">    /**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">     * 不断的向 hashSet 集合添加数据</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">     */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">    public static void addHashSetThread() &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">        //</span> 初始化常量</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">new</span> Thread<span class="function"><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            int count = <span class="number">0</span>;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                <span class="keyword">try</span> &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    hashSet.add(<span class="string">"count"</span> + count);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    Thread.sleep(<span class="number">10000</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    count++;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    e.printStackTrace();</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">        &#125;)</span>.<span class="title">start</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="function">    <span class="title">public</span> <span class="title">static</span> <span class="title">void</span> <span class="title">cpu</span><span class="params">()</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">cpuHigh</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">cpuNormal</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"><span class="function">    /**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="function">     * 极度消耗<span class="title">CPU</span>的线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="function">     */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"><span class="function">    <span class="title">private</span> <span class="title">static</span> <span class="title">void</span> <span class="title">cpuHigh</span><span class="params">()</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Thread</span> <span class="title">thread</span> = <span class="title">new</span> <span class="title">Thread</span><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.info(<span class="string">"cpu start 100"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">        &#125;)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line"><span class="function">        // 添加到线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">executorService</span>.<span class="title">submit</span><span class="params">(thread)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"><span class="function">    /**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"><span class="function">     * 普通消耗<span class="title">CPU</span>的线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"><span class="function">     */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"><span class="function">    <span class="title">private</span> <span class="title">static</span> <span class="title">void</span> <span class="title">cpuNormal</span><span class="params">()</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">for</span> <span class="params">(int i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"><span class="function">            <span class="title">new</span> <span class="title">Thread</span><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    log.info(<span class="string">"cpu start"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    <span class="keyword">try</span> &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                        Thread.sleep(<span class="number">3000</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                        e.printStackTrace();</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;)</span>.<span class="title">start</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line"><span class="function">        &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line"><span class="function">    /**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"><span class="function">     * 模拟线程阻塞,向已经满了的线程池提交线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"><span class="function">     */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line"><span class="function">    <span class="title">private</span> <span class="title">static</span> <span class="title">void</span> <span class="title">thread</span><span class="params">()</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Thread</span> <span class="title">thread</span> = <span class="title">new</span> <span class="title">Thread</span><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.debug(<span class="string">"thread start"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                <span class="keyword">try</span> &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    Thread.sleep(<span class="number">3000</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    e.printStackTrace();</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">        &#125;)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line"><span class="function">        // 添加到线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">executorService</span>.<span class="title">submit</span><span class="params">(thread)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"><span class="function">    /**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"><span class="function">     * 死锁</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"><span class="function">     */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line"><span class="function">    <span class="title">private</span> <span class="title">static</span> <span class="title">void</span> <span class="title">deadThread</span><span class="params">()</span> &#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line"><span class="function">        /** 创建资源 */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Object</span> <span class="title">resourceA</span> = <span class="title">new</span> <span class="title">Object</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Object</span> <span class="title">resourceB</span> = <span class="title">new</span> <span class="title">Object</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"><span class="function">        // 创建线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Thread</span> <span class="title">threadA</span> = <span class="title">new</span> <span class="title">Thread</span><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            synchronized (resourceA) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.info(Thread.currentThread() + <span class="string">" get ResourceA"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                <span class="keyword">try</span> &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    Thread.sleep(<span class="number">1000</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    e.printStackTrace();</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.info(Thread.currentThread() + <span class="string">"waiting get resourceB"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                synchronized (resourceB) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    log.info(Thread.currentThread() + <span class="string">" get resourceB"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">        &#125;)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">Thread</span> <span class="title">threadB</span> = <span class="title">new</span> <span class="title">Thread</span><span class="params">(() -&gt; &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            synchronized (resourceB) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.info(Thread.currentThread() + <span class="string">" get ResourceB"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                <span class="keyword">try</span> &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    Thread.sleep(<span class="number">1000</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    e.printStackTrace();</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                log.info(Thread.currentThread() + <span class="string">"waiting get resourceA"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                synchronized (resourceA) &#123;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                    log.info(Thread.currentThread() + <span class="string">" get resourceA"</span>);</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">                &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">            &#125;</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="params">        &#125;)</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">threadA</span>.<span class="title">start</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line"><span class="function">        <span class="title">threadB</span>.<span class="title">start</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line"><span class="function">    &#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line"><span class="function">&#125;</span></span></pre></td></tr></table></figure>

<h2 id="4-1-全局监控"><a href="#4-1-全局监控" class="headerlink" title="4.1 全局监控"></a>4.1 全局监控</h2><p>使用 <strong>dashboard</strong> 命令可以概览程序的 线程、内存、GC、运行环境信息。<br><img src="http://image.winrains.cn/2019/11/9e0b7-1571212470373.png" alt="dashboard"></p>
<h2 id="4-2-CPU-为什么起飞了"><a href="#4-2-CPU-为什么起飞了" class="headerlink" title="4.2 CPU 为什么起飞了"></a>4.2 CPU 为什么起飞了</h2><p>上面的代码例子有一个 <code>CPU</code> 空转的死循环，非常的消耗 <code>CPU性能</code>，那么怎么找出来呢？<br>使用 <strong>thread</strong>查看<strong>所有</strong>线程信息，同时会列出每个线程的 <code>CPU</code> 使用率，可以看到图里 ID 为12 的线程 CPU 使用100%。<br><img src="http://image.winrains.cn/2019/11/add7f-1570983440457.png" alt="img"><br>使用命令 <strong>thread 12</strong> 查看 CPU 消耗较高的 12 号线程信息，可以看到 CPU 使用较高的方法和行数（这里的行数可能和上面代码里的行数有区别，因为上面的代码在我写文章时候重新排过版了）。<br><img src="http://image.winrains.cn/2019/11/d4709-1570983401254.png" alt="img"><br>上面是先通过观察总体的线程信息，然后查看具体的线程运行情况。如果只是为了寻找 CPU 使用较高的线程，可以直接使用命令 <strong>thread -n [显示的线程个数]</strong> ，就可以排列出 CPU 使用率 <strong>Top N</strong> 的线程。<br><img src="http://image.winrains.cn/2019/11/4977b-1570983061047.png" alt="img"><br>定位到的 CPU 使用最高的方法。<br><img src="http://image.winrains.cn/2019/11/795d2-1571016675083.png" alt="img"></p>
<h2 id="4-3-线程池线程状态"><a href="#4-3-线程池线程状态" class="headerlink" title="4.3 线程池线程状态"></a>4.3 线程池线程状态</h2><p>定位线程问题之前，先回顾一下线程的几种常见状态：</p>
<ul>
<li><p><strong>RUNNABLE</strong> 运行中</p>
</li>
<li><p>TIMED_WAITIN</p>
<p> 调用了以下方法的线程会进入</p>
<p>TIMED_WAITING</p>
<p>：</p>
<ol>
<li>Thread#sleep()</li>
<li>Object#wait() 并加了超时参数</li>
<li>Thread#join() 并加了超时参数</li>
<li>LockSupport#parkNanos()</li>
<li>LockSupport#parkUntil()</li>
</ol>
</li>
<li><p>WAITING</p>
<p> 当线程调用以下方法时会进入WAITING状态：</p>
<ol>
<li>Object#wait() 而且不加超时参数</li>
<li>Thread#join() 而且不加超时参数</li>
<li>LockSupport#park()</li>
</ol>
</li>
<li><p><strong>BLOCKED</strong> 阻塞，等待锁</p>
</li>
</ul>
<p>上面的模拟代码里，定义了线程池大小为1 的线程池，然后在 <code>cpuHigh</code> 方法里提交了一个线程，在 <code>thread</code>方法再次提交了一个线程，后面的这个线程因为线程池已满，会阻塞下来。<br>使用 <strong>thread | grep pool</strong> 命令查看线程池里线程信息。<br><img src="http://image.winrains.cn/2019/11/3ac1e-1571020871537.png" alt="img"><br>可以看到线程池有 <strong>WAITING</strong> 的线程。<br><img src="http://image.winrains.cn/2019/11/1b4bd-1571021838323.png" alt="img"></p>
<h2 id="4-4-线程死锁"><a href="#4-4-线程死锁" class="headerlink" title="4.4 线程死锁"></a>4.4 线程死锁</h2><p>上面的模拟代码里 <code>deadThread</code>方法实现了一个死锁，使用 <strong>thread -b</strong> 命令查看直接定位到死锁信息。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * 死锁</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> static void dead<span class="constructor">Thread()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">/** 创建资源 */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    Object resourceA = <span class="keyword">new</span> <span class="constructor">Object()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    Object resourceB = <span class="keyword">new</span> <span class="constructor">Object()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="comment">// 创建线程</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    Thread threadA = <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        synchronized (resourceA) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">            log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">" get ResourceA"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">1000</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">            &#125; catch (InterruptedException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">                e.print<span class="constructor">StackTrace()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">            log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">"waiting get resourceB"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">            synchronized (resourceB) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">                log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">" get resourceB"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    Thread threadB = <span class="keyword">new</span> <span class="constructor">Thread(()</span> -&gt; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        synchronized (resourceB) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">            log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">" get ResourceB"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">1000</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">            &#125; catch (InterruptedException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">                e.print<span class="constructor">StackTrace()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">            log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">"waiting get resourceA"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">            synchronized (resourceA) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">                log.info(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span> + <span class="string">" get resourceA"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">    threadA.start<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">    threadB.start<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>检查到的死锁信息。<br><img src="http://image.winrains.cn/2019/11/59db9-1571206638142.png" alt="img"></p>
<h2 id="4-5-反编译"><a href="#4-5-反编译" class="headerlink" title="4.5 反编译"></a>4.5 反编译</h2><p>上面的代码放到了包 <code>com</code>下，假设这是一个线程环境，当怀疑当前运行的代码不是自己想要的代码时，可以直接反编译出代码，也可以选择性的查看类的字段或方法信息。<br>如果怀疑不是自己的代码，可以使用 <strong>jad</strong> 命令直接反编译 class。<br><img src="http://image.winrains.cn/2019/11/8818b-image-20191106012005747.png" alt="jad"><br><code>jad</code> 命令还提供了一些其他参数：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"># 反编译只显示源码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">jad --<span class="keyword">source</span>-<span class="keyword">only</span> <span class="keyword">com</span>.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"># 反编译某个类的某个方法</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">jad --<span class="keyword">source</span>-<span class="keyword">only</span> <span class="keyword">com</span>.Arthas mysql</span></pre></td></tr></table></figure>

<h2 id="4-6-查看字段信息"><a href="#4-6-查看字段信息" class="headerlink" title="4.6 查看字段信息"></a>4.6 查看字段信息</h2><p>使用 <strong>sc -d -f</strong>  命令查看类的字段信息。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[arthas@20252]$ sc -d -f com.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">sc -d -f com.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"> class-<span class="builtin-name">info</span>        com.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"> code-source       /C:/Users/Niu/Desktop/arthas/target/classes/</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"> name              com.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"> isInterface       <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"> isAnnotation      <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"> isEnum            <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"> isAnonymousClass  <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"> isArray           <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"> isLocalClass      <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"> isMemberClass     <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"> isPrimitive       <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"> isSynthetic       <span class="literal">false</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"> simple-name       Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"> modifier          public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"> annotation</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"> interfaces</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"> super-class       +-java.lang.Object</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"> class-loader      +-sun.misc.Launcher<span class="variable">$AppClassLoader</span>@18b4aac2</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">                     +-sun.misc.Launcher<span class="variable">$ExtClassLoader</span>@2ef1e4fa</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"> classLoaderHash   18b4aac2</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"> fields            modifierfinal,private,static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">                  <span class="built_in"> type </span>   org.slf4j.Logger</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">                   name    log</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">                   value   Logger[com.Arthas]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">                   modifierprivate,static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">                  <span class="built_in"> type </span>   java.util.HashSet</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">                   name    hashSet</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">                   value   [count1, count2]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">                   modifierprivate,static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">                  <span class="built_in"> type </span>   java.util.concurrent.ExecutorService</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">                   name    executorService</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">                   value   java.util.concurrent.ThreadPoolExecutor@71c03156[Ru</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">                           nning,<span class="built_in"> pool </span>size = 1, active threads = 1, queued ta</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">                           sks = 0, completed tasks = 0]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">Affect(row-cnt:1) cost <span class="keyword">in</span> 9 ms.</span></pre></td></tr></table></figure>

<h2 id="4-7-查看方法信息"><a href="#4-7-查看方法信息" class="headerlink" title="4.7 查看方法信息"></a>4.7 查看方法信息</h2><p>使用 <strong>sm</strong> 命令查看类的方法信息。</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="subst">@22180</span>]$ sm <span class="keyword">com</span>.Arthas</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas &lt;init&gt;()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas start()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas thread()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas deadThread()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$cpuHigh</span><span class="number">$1</span>()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas cpuHigh()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$thread</span><span class="number">$3</span>()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas addHashSetThread()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas cpuNormal()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas cpu()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$addHashSetThread</span><span class="number">$0</span>()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$deadThread</span><span class="number">$4</span>(Ljava/lang/Object<span class="comment">;Ljava/lang/Object;)V</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$deadThread</span><span class="number">$5</span>(Ljava/lang/Object<span class="comment">;Ljava/lang/Object;)V</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">com</span>.Arthas lambda<span class="number">$cpuNormal</span><span class="number">$2</span>()V</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">Affect(row-cnt:<span class="number">16</span>) cost <span class="keyword">in</span> <span class="number">6</span> ms.</span></pre></td></tr></table></figure>

<h2 id="4-8-对变量的值很是好奇"><a href="#4-8-对变量的值很是好奇" class="headerlink" title="4.8 对变量的值很是好奇"></a>4.8 对变量的值很是好奇</h2><p>使用 <strong>ognl</strong> 命令，ognl 表达式可以轻松操作想要的信息。<br>代码还是上面的示例代码，我们查看变量 <code>hashSet</code> 中的数据：<br><img src="http://image.winrains.cn/2019/11/c8ccb-1571196786678.png" alt="img"><br>查看静态变量 <code>hashSet</code> 信息。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]<span class="variable">$ </span>ognl <span class="string">'@com.Arthas@hashSet'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@HashSet</span>[</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count1],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count2],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count29],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count28],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count0],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count27],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count5],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count26],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count6],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count25],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count3],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[count24],</span></pre></td></tr></table></figure>

<p>查看静态变量 hashSet 大小。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]<span class="variable">$ </span>ognl <span class="string">'@com.Arthas@hashSet.size()'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="variable">@Integer</span>[<span class="number">57</span>]</span></pre></td></tr></table></figure>

<p>甚至可以进行操作。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]<span class="variable">$ </span>ognl  <span class="string">'@com.Arthas@hashSet.add("test")'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="variable">@Boolean</span>[<span class="keyword">true</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]$</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看添加的字符</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]<span class="variable">$ </span>ognl  <span class="string">'@com.Arthas@hashSet'</span> | grep test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@String</span>[test],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">[arthas<span class="variable">@19856</span>]$</span></pre></td></tr></table></figure>

<p><code>ognl</code> 可以做很多事情，可以参考 <a href="https://github.com/alibaba/arthas/issues/71" target="_blank" rel="noopener">ognl 表达式特殊用法( https://github.com/alibaba/arthas/issues/71 )</a>。</p>
<h2 id="4-9-程序有没有问题"><a href="#4-9-程序有没有问题" class="headerlink" title="4.9 程序有没有问题"></a>4.9 程序有没有问题</h2><h3 id="4-9-1-运行较慢、耗时较长"><a href="#4-9-1-运行较慢、耗时较长" class="headerlink" title="4.9.1 运行较慢、耗时较长"></a>4.9.1 运行较慢、耗时较长</h3><p>使用 <strong>trace</strong> 命令可以跟踪统计方法耗时<br>这次换一个模拟代码。一个最基础的 Springboot 项目（当然，不想 Springboot 的话，你也可以直接在 UserController 里 main 方法启动）控制层 <code>getUser</code> 方法调用了 <code>userService.get(uid);</code>，这个方法中分别进行<code>check</code>、<code>service</code>、<code>redis</code>、<code>mysql</code>操作。</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@RestController</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@Slf4j</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class UserController &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    @Autowired</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> UserServiceImpl userService;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    @GetMapping(value = <span class="string">"/user"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, <span class="keyword">Object</span>&gt; getUser(Integer uid) <span class="keyword">throws</span> Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">// 模拟用户查询</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        userService.<span class="built_in">get</span>(uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, <span class="keyword">Object</span>&gt; hashMap = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;&gt;();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        hashMap.put(<span class="string">"uid"</span>, uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        hashMap.put(<span class="string">"name"</span>, <span class="string">"name"</span> + uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> hashMap;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>模拟代码 Service:</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@Service</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@Slf4j</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> UserServiceImpl &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="built_in">public</span> <span class="type">void</span> <span class="keyword">get</span>(<span class="type">Integer</span> uid) throws <span class="keyword">Exception</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">check</span>(uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        service(uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        redis(uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        mysql(uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="built_in">public</span> <span class="type">void</span> service(<span class="type">Integer</span> uid) throws <span class="keyword">Exception</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">            count += i;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">log</span>.<span class="keyword">info</span>("service  end &#123;&#125;", count);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    <span class="built_in">public</span> <span class="type">void</span> redis(<span class="type">Integer</span> uid) throws <span class="keyword">Exception</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        <span class="type">int</span> count = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">            count += i;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">log</span>.<span class="keyword">info</span>("redis  end &#123;&#125;", count);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    <span class="built_in">public</span> <span class="type">void</span> mysql(<span class="type">Integer</span> uid) throws <span class="keyword">Exception</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        long count = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">            count += i;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">log</span>.<span class="keyword">info</span>("mysql end &#123;&#125;", count);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"> 	 <span class="built_in">public</span> <span class="type">boolean</span> <span class="keyword">check</span>(<span class="type">Integer</span> uid) throws <span class="keyword">Exception</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">         <span class="keyword">if</span> (uid == <span class="keyword">null</span> || uid &lt; <span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">             <span class="keyword">log</span>.error("uid不正确，uid:&#123;&#125;", uid);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">             throw <span class="built_in">new</span> <span class="keyword">Exception</span>("uid不正确");</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">         &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">     &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>运行 Springboot 之后，使用 <strong>trace==</strong>  命令开始检测耗时情况。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[<span class="symbol">arthas@</span><span class="number">6592</span>]$ trace com.UserController getUser</span></pre></td></tr></table></figure>

<p>访问接口 <code>/getUser</code> ，可以看到耗时信息，看到 <code>com.UserServiceImpl:get()</code>方法耗时较高。<br><img src="http://image.winrains.cn/2019/11/62a2b-1571208153793.png" alt="img"><br>继续跟踪耗时高的方法，然后再次访问。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">[<span class="symbol">arthas@</span><span class="number">6592</span>]$ trace com.UserServiceImpl <span class="keyword">get</span></span></pre></td></tr></table></figure>

<p><img src="http://image.winrains.cn/2019/11/f139e-1571208245597.png" alt="img"><br>很清楚的看到是 <code>com.UserServiceImpl</code>的 <code>mysql</code>方法耗时是最高的。</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">Affect(<span class="keyword">class</span>-cnt:<span class="number">1</span> , <span class="function"><span class="keyword">method</span>-<span class="title">cnt</span>:</span><span class="number">1</span>) cost <span class="keyword">in</span> <span class="number">31</span> ms.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">`---ts=<span class="number">2019</span>-<span class="number">10</span>-<span class="number">16</span> <span class="number">14</span>:<span class="number">40</span>:<span class="number">10</span>;thread_name=http-nio-<span class="number">8080</span>-exec-<span class="number">8</span>;id=<span class="number">1</span>f;is_daemon=<span class="keyword">true</span>;priority=<span class="number">5</span>;TCCL=org.springframework.boot.web.embedded.tomcat.TomcatEmbeddedWebappClassLoader@<span class="number">23</span>a918c7</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    `---[<span class="number">6.792201</span>ms] com.UserServiceImpl:get()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        +---[<span class="number">0.008</span>ms] com.UserServiceImpl:check() <span class="string">#17</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        +---[<span class="number">0.076</span>ms] com.UserServiceImpl:service() <span class="string">#18</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        +---[<span class="number">0.1089</span>ms] com.UserServiceImpl:redis() <span class="string">#19</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        `---[<span class="number">6.528899</span>ms] com.UserServiceImpl:mysql() <span class="string">#20</span></span></pre></td></tr></table></figure>

<h3 id="4-9-2-统计方法耗时"><a href="#4-9-2-统计方法耗时" class="headerlink" title="4.9.2 统计方法耗时"></a>4.9.2 统计方法耗时</h3><p>使用 <strong>monitor</strong> 命令监控统计方法的执行情况。<br>每5秒统计一次 <code>com.UserServiceImpl</code> 类的 <code>get</code> 方法执行情况。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">monitor -<span class="built_in">c</span> <span class="number">5</span> com.<span class="type">UserServiceImpl</span> <span class="keyword">get</span></span></pre></td></tr></table></figure>

<p><img src="http://image.winrains.cn/2019/11/59e40-1571210158018.png" alt="img"></p>
<h2 id="4-10-想观察方法信息"><a href="#4-10-想观察方法信息" class="headerlink" title="4.10 想观察方法信息"></a>4.10 想观察方法信息</h2><p>下面的示例用到了文章的前两个模拟代码。</p>
<h3 id="4-10-1-观察方法的入参出参信息"><a href="#4-10-1-观察方法的入参出参信息" class="headerlink" title="4.10.1 观察方法的入参出参信息"></a>4.10.1 观察方法的入参出参信息</h3><p>使用 <strong>watch</strong> 命令轻松查看输入输出参数以及异常等信息。</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">USAGE:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  watch [-b] [-e] [-x &lt;value&gt;] [-f] [-h] [-n &lt;value&gt;] [-E] [-M &lt;value&gt;] [-s] class-pattern method-pattern express [condition-express]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">SUMMARY:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">  Display the input/output parameter,<span class="built_in"> return </span>object,<span class="built_in"> and </span>thrown exception of specified method invocation</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">  The express may be one of the following expression (evaluated dynamically):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">          target<span class="keyword"> :</span> the object</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">           clazz<span class="keyword"> :</span> the object's class</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">          method<span class="keyword"> :</span> the<span class="keyword"> constructor</span><span class="built_in"> or </span>method</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">          params<span class="keyword"> :</span> the parameters<span class="built_in"> array </span>of method</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    params[0..n]<span class="keyword"> :</span> the element of parameters array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">       returnObj<span class="keyword"> :</span> the returned object of method</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        throwExp<span class="keyword"> :</span> the<span class="built_in"> throw </span>exception of method</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        isReturn<span class="keyword"> :</span> the method ended by return</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">         isThrow<span class="keyword"> :</span> the method ended by throwing exception</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">           <span class="comment">#cost : the execution time in ms of method invocation</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">Examples:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">  watch -b org.apache.commons.lang.StringUtils isBlank params</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">  watch -f org.apache.commons.lang.StringUtils isBlank returnObj</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">  watch org.apache.commons.lang.StringUtils isBlank '&#123;params, target, returnObj&#125;' -x 2</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">  watch -bf *StringUtils isBlank params</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">  watch *StringUtils isBlank params[0]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">  watch *StringUtils isBlank params[0] params[0].length==1</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">  watch *StringUtils isBlank params '<span class="comment">#cost&gt;100'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">  watch -E -b org\.apache\.commons\.lang\.StringUtils isBlank params[0]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">WIKI:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">  https://alibaba.github.io/arthas/watch</span></pre></td></tr></table></figure>

<p>常用操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看入参和出参</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> watch com.Arthas addHashSet <span class="string">'&#123;params[0],returnObj&#125;'</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看入参和出参大小</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> watch com.Arthas addHashSet <span class="string">'&#123;params[0],returnObj.size&#125;'</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看入参和出参中是否包含 <span class="string">'count10'</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> watch com.Arthas addHashSet <span class="string">'&#123;params[0],returnObj.contains("count10")&#125;'</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看入参和出参，出参 toString</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> watch com.Arthas addHashSet <span class="string">'&#123;params[0],returnObj.toString()&#125;'</span></span></span></pre></td></tr></table></figure>

<p>查看入参出参。<br><img src="http://image.winrains.cn/2019/11/ea60d-1571196483469.png" alt="img"><br>查看返回的异常信息。</p>
<h3 id="4-10-2-观察方法的调用路径"><a href="#4-10-2-观察方法的调用路径" class="headerlink" title="4.10.2 观察方法的调用路径"></a>4.10.2 观察方法的调用路径</h3><p>使用 <strong>stack</strong>命令查看方法的调用信息。</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta"># 观察 类com.UserServiceImpl的 mysql 方法调用路径</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">stack <span class="keyword">com</span>.UserServiceImpl mysql</span></pre></td></tr></table></figure>

<p><img src="http://image.winrains.cn/2019/11/6654e-1571210706602.png" alt="img"></p>
<h3 id="4-10-3-方法调用时空隧道"><a href="#4-10-3-方法调用时空隧道" class="headerlink" title="4.10.3 方法调用时空隧道"></a>4.10.3 方法调用时空隧道</h3><p>使用 <strong>tt</strong> 命令记录方法执行的详细情况。</p>
<blockquote>
<p><strong>tt</strong> 命令方法执行数据的时空隧道，记录下指定方法每次调用的入参和返回信息，并能对这些不同的时间下调用进行观测 。</p>
</blockquote>
<p>常用操作：<br>开始记录方法调用信息：tt -t com.UserServiceImpl check<br><img src="http://image.winrains.cn/2019/11/1ef63-1571212007249.png" alt="img"><br>可以看到记录中 INDEX=1001 的记录的 IS-EXP = true ，说明这次调用出现异常。<br>查看记录的方法调用信息： tt -l<br><img src="http://image.winrains.cn/2019/11/adc02-1571212080071.png" alt="img"><br>查看调用记录的详细信息（-i 指定 INDEX）： tt -i 1001<br><img src="http://image.winrains.cn/2019/11/9edea-1571212151064.png" alt="img"><br>可以看到 INDEX=1001 的记录的异常信息。<br>重新发起调用，使用指定记录，使用 -p 重新调用。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">tt -i <span class="number">1001</span> -p</span></pre></td></tr></table></figure>

<p><img src="http://image.winrains.cn/2019/11/d76c1-1571212227058.png" alt="img"><br>文中代码已经上传到 <a href="https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas" target="_blank" rel="noopener">Github</a>。<br><a href="https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas" target="_blank" rel="noopener">https://github.com/niumoo/lab-notes/tree/master/src/main/java/net/codingme/arthas</a></p>
<blockquote>
<p>作者：未读代码</p>
<p>来源：<a href="https://www.codingme.net/2019/11/arthas/" target="_blank" rel="noopener">https://www.codingme.net/2019/11/arthas/</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Arthas/" rel="tag"># Arthas</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/01/08/Spring-Boot%E6%95%99%E7%A8%8B%EF%BC%8815%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E8%87%AA%E5%B7%B1%E7%9A%84-Springboot-starter/" rel="prev" title="Spring Boot教程（15）：如何编写自己的 Springboot starter">
      <i class="fa fa-chevron-left"></i> Spring Boot教程（15）：如何编写自己的 Springboot starter
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/08/Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%EF%BC%88JMM%EF%BC%89%E8%AF%A6%E8%A7%A3/" rel="next" title="Java内存模型（JMM）详解">
      Java内存模型（JMM）详解 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1、Arthas-介绍"><span class="nav-number">2.</span> <span class="nav-text">1、Arthas 介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2、Arthas-使用场景"><span class="nav-number">3.</span> <span class="nav-text">2、Arthas 使用场景</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3、Arthas-怎么用"><span class="nav-number">4.</span> <span class="nav-text">3、Arthas 怎么用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-安装"><span class="nav-number">4.1.</span> <span class="nav-text">3.1 安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-运行"><span class="nav-number">4.2.</span> <span class="nav-text">3.2 运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-web-console"><span class="nav-number">4.3.</span> <span class="nav-text">3.3 web console</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-常用命令"><span class="nav-number">4.4.</span> <span class="nav-text">3.4 常用命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-退出"><span class="nav-number">4.5.</span> <span class="nav-text">3.5 退出</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4、Arthas-常用操作"><span class="nav-number">5.</span> <span class="nav-text">4、Arthas 常用操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-全局监控"><span class="nav-number">5.1.</span> <span class="nav-text">4.1 全局监控</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-CPU-为什么起飞了"><span class="nav-number">5.2.</span> <span class="nav-text">4.2 CPU 为什么起飞了</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-线程池线程状态"><span class="nav-number">5.3.</span> <span class="nav-text">4.3 线程池线程状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-线程死锁"><span class="nav-number">5.4.</span> <span class="nav-text">4.4 线程死锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-反编译"><span class="nav-number">5.5.</span> <span class="nav-text">4.5 反编译</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-查看字段信息"><span class="nav-number">5.6.</span> <span class="nav-text">4.6 查看字段信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-查看方法信息"><span class="nav-number">5.7.</span> <span class="nav-text">4.7 查看方法信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-8-对变量的值很是好奇"><span class="nav-number">5.8.</span> <span class="nav-text">4.8 对变量的值很是好奇</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-9-程序有没有问题"><span class="nav-number">5.9.</span> <span class="nav-text">4.9 程序有没有问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-1-运行较慢、耗时较长"><span class="nav-number">5.9.1.</span> <span class="nav-text">4.9.1 运行较慢、耗时较长</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9-2-统计方法耗时"><span class="nav-number">5.9.2.</span> <span class="nav-text">4.9.2 统计方法耗时</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-10-想观察方法信息"><span class="nav-number">5.10.</span> <span class="nav-text">4.10 想观察方法信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-1-观察方法的入参出参信息"><span class="nav-number">5.10.1.</span> <span class="nav-text">4.10.1 观察方法的入参出参信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-2-观察方法的调用路径"><span class="nav-number">5.10.2.</span> <span class="nav-text">4.10.2 观察方法的调用路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-10-3-方法调用时空隧道"><span class="nav-number">5.10.3.</span> <span class="nav-text">4.10.3 方法调用时空隧道</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">congsheng.wang</p>
  <div class="site-description" itemprop="description">trouble is a friend</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">984</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">94</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">156</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">congsheng.wang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
