<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://congsheng.wang').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="1、引言MySQL作为开源技术的代表作之一，是互联网得以广泛流行的重要基础技术之一。国外 GitHub、Airbnb、Yelp、Coursera 均在使用 MySQL 数据库，国内阿里巴巴、去哪儿网、腾讯、魅族、京东等等的部分关键业务同样使用了 MySQL 数据库。同时，MySQL 也是众多数据库排行榜单的第一名，丛多国内一线互联网企业都在用的开源数据库。MySQL在互联网项目中如此流行，众多的开">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL大表优化方案总结">
<meta property="og:url" content="http:&#x2F;&#x2F;congsheng.wang&#x2F;2019&#x2F;12&#x2F;27&#x2F;MySQL%E5%A4%A7%E8%A1%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93&#x2F;index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="1、引言MySQL作为开源技术的代表作之一，是互联网得以广泛流行的重要基础技术之一。国外 GitHub、Airbnb、Yelp、Coursera 均在使用 MySQL 数据库，国内阿里巴巴、去哪儿网、腾讯、魅族、京东等等的部分关键业务同样使用了 MySQL 数据库。同时，MySQL 也是众多数据库排行榜单的第一名，丛多国内一线互联网企业都在用的开源数据库。MySQL在互联网项目中如此流行，众多的开">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;7f692-191727ij5yg6ylywsk6w5f.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;e56c5-191909r3tyzslyojotl33f.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;94c8c-192843ol3kjz93wqjnkz57.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;7244a-194033c8z4606v6qhqqa6q.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;24a90-194340wzkjydafezbikfyf.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;c3148-194341w6r2nvnxnrnv4ayq.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;d1b53-194341uhaydgb2iiyx2gh8.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;ce654-200643flfcaqz8u8llsbtf.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;523fb-201848i2jjd2rt2em4rto2.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;a087f-201904wzma8arsmyxxpqyy.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;d5560-202453wvpnf0441z89yyy9.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;3d704-203632sahtc790wc69isam.png">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;18b3e-203750rv4cvxcvvdxumgux.png">
<meta property="og:updated_time" content="2019-12-27T09:30:55.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;09&#x2F;7f692-191727ij5yg6ylywsk6w5f.jpg">

<link rel="canonical" href="http://congsheng.wang/2019/12/27/MySQL%E5%A4%A7%E8%A1%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>MySQL大表优化方案总结 | 个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">congsheng的博客</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">141</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">91</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">807</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://congsheng.wang/2019/12/27/MySQL%E5%A4%A7%E8%A1%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="congsheng.wang">
      <meta itemprop="description" content="trouble is a friend">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL大表优化方案总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-12-27 17:30:55" itemprop="dateCreated datePublished" datetime="2019-12-27T17:30:55+08:00">2019-12-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="1、引言"><a href="#1、引言" class="headerlink" title="1、引言"></a>1、引言</h2><p><img src="http://image.winrains.cn/2019/09/7f692-191727ij5yg6ylywsk6w5f.jpg" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_1.jpg"><br>MySQL作为开源技术的代表作之一，是互联网得以广泛流行的重要基础技术之一。<br>国外 GitHub、Airbnb、Yelp、Coursera 均在使用 MySQL 数据库，国内阿里巴巴、去哪儿网、腾讯、魅族、京东等等的部分关键业务同样使用了 MySQL 数据库。同时，MySQL 也是众多数据库排行榜单的第一名，丛多国内一线互联网企业都在用的开源数据库。<br>MySQL在互联网项目中如此流行，众多的开发者们在各种应用场景下总结了许多MySQL的最佳实践。本文将总结和分享当MySQL单表记录数过大时，增删改查性能急剧下降问题的优化思路，这也是资深后端架构师、程序员所必备的知识内容之一，希望本文对你有用。</p>
<a id="more"></a>

<h2 id="2、关于MySQL"><a href="#2、关于MySQL" class="headerlink" title="2、关于MySQL"></a>2、关于MySQL</h2><h3 id="2-1-MySQL之父"><a href="#2-1-MySQL之父" class="headerlink" title="2.1 MySQL之父"></a>2.1 MySQL之父</h3><p><img src="http://image.winrains.cn/2019/09/e56c5-191909r3tyzslyojotl33f.jpg" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_2.jpg"><br>▲ MySQL之父：Ulf Michael “Monty” Widenius<br>Michael “Monty” Widenius, 1962年3月3日出生于芬兰赫尔辛基。开源 MySQL数据库的创始成员、MySQL AB公司的首席技术官、MySQL数据库第一行代码的作者、MySQL数据库命名人、MariaDB创始人兼首席技术官；独自完成撰写MySQL数据库服务器端95%的代码。<br>Monty是MySQL第一行代码的作者，后来与两位好友一起成立了MySQL AB，开始正式商业化运作MySQL，出任CTO，一直到MySQL AB被卖给Sun。之后Monty没有加入Sun，而是离职创立了Monty Program AB，接过MySQL的代码继续开发新的分支——MariaDB，自己担任CEO。<br>在2014年，Monty Program AB与SkySQL AB合并，成立了MariaDB Corporation，开始商业化运作MariaDB，Monty继续担任新公司的CTO。同时他还兼任MariaDB基金会的CTO。<br><strong>关于MariaDB、MySQL、MaxDB名字的由来：</strong></p>
<p>Monty有一个女儿，名叫My，因此他将自己开发的数据库命名为MySQL。Monty还有一个儿子，名为Max，因此在2003年，SAP公司与MySQL公司建立合作伙伴关系后，Monty又将与SAP合作开发的数据库命名为MaxDB。而现在的MariaDB中的Maria是Monty小孙女的名字。</p>
<h3 id="2-2-MySQL历史"><a href="#2-2-MySQL历史" class="headerlink" title="2.2 MySQL历史"></a>2.2 MySQL历史</h3><p>MySQL的海豚标志的名字叫“sakila”，它是由MySQL AB的创始人从用户在“海豚命名”的竞赛中建议的大量的名字表中选出的。获胜的名字是由来自非洲斯威士兰的开源软件开发者Ambrose Twebaze提供。根据Ambrose所说，Sakila来自一种叫SiSwati的斯威士兰方言，也是在Ambrose的家乡乌干达附近的坦桑尼亚的Arusha的一个小镇的名字。<br>MySQL的历史可以追溯到1979年。当时Allan Larsson和Michael Widenius(Monty)开了一家自己的咨询公司，取名TcX，名字的由来已无从考证。有道是”前世尽付真情，今生亦现福缘积厚”。那年一个夜黑风高的晚上，Michael基于BASIC语言写出了他的第一款数据库报表工具UNIREG。<br>有当年的天气记录为证，Michael写完该工具时极光异常明亮，炫彩无比。大凡重大事情的发生，后来的著述人都会记录有一些类似的怪现象。比如刮风、下雨、冒仙气什么的，还有天上星星异常闪烁等等，反正就是说明这种事情很不简单。<br>最初的UNIREG是运行在瑞典人制造的ABC800计算机上的。ABC800的内存只有32KB，CPU是频率只有4MHz的Z80。在1983年Monty遇到了David Axmark，两人相见恨晚，开始合作运营TcX，Monty负责技术，David搞管理。后来TcX将UNIREG移植到其他更加强大的硬件平台，主要是Sun的平台。<br><img src="http://image.winrains.cn/2019/09/94c8c-192843ol3kjz93wqjnkz57.jpg" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_3.jpg"><br>▲ ABC800计算机<br>1995年5月23日，MySQL的第一个内部版本发行了，并在第二年对外公布了MySQL官方正式发行版(3.11.1)。有趣的是，第一个MySQL正式版恰巧只能运行在Sun Solaris上，仿佛昭示了它日后被Sun收购的命运。<br>在接下来的两年中，MySQL被移植到不同的平台，同时加入了不少新的特性。到1998时，MySQL能够运行在10多种操作系统之上，其中包括应用非常广泛的 FreeBSD、Linux、Windows 95和Windows NT等。很快MySQL 3.22也发布了，但它仍然存在很多问题–如不支持事务操作、子查询、外键、存储过程和视图等功能。正因为这些缺陷，当时许多Oracle和SQL Server的用户对MySQL根本不屑一顾。<br>大概在1999的冬天，下了很大一场雪。然后独立的商业公司MySQL AB就在瑞典的中部城市Uppsala成立了。并于同年发布了包含事务型存储引擎BDB的MySQL 3.23。在集成BDB存储引擎的过程中，MySQL开发团队得到了很好的锻炼，为后来能将InnoDB整合以及开发开放插件式的存储引擎架构打下了坚实的基础。<br>MySQL从诞生之初就提供了双重的授权标准：个人使用是免费的，如果用于商业网站搭建或者Windows平台下就必须购买商业许可证。在2000年的时候MySQL做了一个重大的决定，改换成了GPL许可模式，也就是说商业用户也无需再购买许可证，但必须把他们的源码公开。虽然MySQL AB因此在收入上遭受了巨大的打击，损失了将近80%的收入，但他们依然坚持了GPL许可模式。<br>与此同时，芬兰公司Heikki开始接触MySQL AB，讨论将Heikki的存储引擎InnoDB整合到MySQL数据库中的可行性。双方的合作非常顺利，并于2001年推出MySQL 4.0 Alpha版本。经过两年的公开测试和应用，到了2003年，包含InnoDB的MySQL已经变得非常稳定了。随即在同一年，MySQL推出4.1版，第一次使得MySQL支持子查询，支持Unicode和预编译SQL等功能。<br>MySQL 4.1还在Alpha版时，公司已决定并行开发5.0版。因为他们打算加快MySQL的开发速度以适应日益苛刻的市场需求。这个新版本是有史以来MySQL最大的变化，添加了存储过程、服务端游标、触发器、查询优化以及分布式事务等在大家看来一个”正常数据库管理系统”应当拥有的一整套功能。<br>2008年2月，当时的业界开源老大Sun Microsystems动用10亿美元收购了MySQL，造就了开源软件的收购最高价。这次交易给开源交易设立了一个新的基准。在此之前的交易金额(JBoss、Zimbra、XenSource、Gluecode)从没接近过10亿美元，全部加起来才差不多与Sun Microsystems购买MySQL的花费持平。MySQL被收购之后，MySQL图标停止使用，取而代之的是Sun/MySQL图标。<br>MySQL和Sun合并之后，推出了MySQL 5.1GA版和MySQL 5.4 Beta版。5.4的推出照搬了4.1和5.0当时的开发模式，让5.4和6.0并行处于Beta开发阶段。<br>螳螂捕蝉，黄雀在后。2009年，数据库老大Oracle大笔一挥，开出74亿美元的支票，将Sun Microsystems和MySQL通盘收于旗下。<br><img src="http://image.winrains.cn/2019/09/7244a-194033c8z4606v6qhqqa6q.jpg" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_4.jpg"><br>▲ SUN被Oracle收购了</p>
<h3 id="2-3-MySQL大事记"><a href="#2-3-MySQL大事记" class="headerlink" title="2.3 MySQL大事记"></a>2.3 MySQL大事记</h3><p>1999年，MySQL AB在瑞典正式宣布成立。<br>2000年，ISAM华丽转身MyISAM存储引擎。同年MySQL开放了自己的源代码，并且基于GPL许可协议。同年9月innoDB推出。<br>2003年，MySQL4.0发布,正式集成innodb<br>2005年，MySQL 5.0发布。同年Oracle把InnoDB引擎的开发公司innobase收购完成。MySQL明确地表现出迈向高性能数据库的发展步伐。<br>2006年，sun公司收购了MySQL公司，出价10亿美元。<br>2009年，Oracle公司收购sun，将MySQL纳入囊中。<br>2010年，MySQL 5.5正式版发布，Oracle完成了大量改进，并将innodb改成默认引擎。<br>2013年，MySQL 5.6 GA版本发布。<br>近期 - MySQL 5.7 GA版本横空出世，其性能、新特性、性能分析带来了质的改变。</p>
<h3 id="2-4-MySQL现状及应用"><a href="#2-4-MySQL现状及应用" class="headerlink" title="2.4 MySQL现状及应用"></a>2.4 MySQL现状及应用</h3><p><img src="http://image.winrains.cn/2019/09/24a90-194340wzkjydafezbikfyf.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_5.png"><br>▲ 全球数据库排行（截止2017年）<br><img src="http://image.winrains.cn/2019/09/c3148-194341w6r2nvnxnrnv4ayq.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_6.png"><br>▲ 全球最大网站Top20的数据库使用情况<br><strong>以下是全球最大网站Top20列表：</strong></p>
<ul>
<li>Facebook.com</li>
<li>Google.com</li>
<li>YouTube.com</li>
<li>Yahoo.com</li>
<li>WIKipedia.org - 维基百科</li>
<li>Live.com – 微软新的电子邮件服务</li>
<li>qq.com – 腾讯</li>
<li>Microsoft.com – 微软产品/更新/下载</li>
<li>Baidu.com – 百度</li>
<li>Msn.com – 微软自有互联网信息</li>
<li>Blogger.com – 博客平台</li>
<li>ASK.com - 搜索引擎</li>
<li>Taobao.com 淘宝</li>
<li>Twiter.com – 实时通讯平台</li>
<li>Bing.com – 必应</li>
<li>Sohu.com – 搜狐</li>
<li>Apple.com – 苹果</li>
<li>WrodPress.com – 成行经历</li>
<li>Sina.com – 新浪</li>
<li>Amazon.com-亚马逊</li>
</ul>
<p><img src="http://image.winrains.cn/2019/09/d1b53-194341uhaydgb2iiyx2gh8.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_7.png"><br>▲ 国内MySQL行业应用</p>
<h2 id="3、MySQL的单表优化干货总结"><a href="#3、MySQL的单表优化干货总结" class="headerlink" title="3、MySQL的单表优化干货总结"></a>3、MySQL的单表优化干货总结</h2><p>除非单表数据未来会一直不断上涨，否则不要一开始就考虑拆分，拆分会带来逻辑、部署、运维的各种复杂度，一般以整型值为主的表在千万级以下，字符串为主的表在五百万以下是没有太大问题的。而事实上很多时候MySQL单表的性能依然有不少优化空间，甚至能正常支撑千万级以上的数据量。</p>
<h3 id="3-1-“字段”优化总结"><a href="#3-1-“字段”优化总结" class="headerlink" title="3.1 “字段”优化总结"></a>3.1 “字段”优化总结</h3><ul>
<li>1）尽量使用TINYINT、SMALLINT、MEDIUM_INT作为整数类型而非INT，如果非负则加上UNSIGNED；</li>
<li>2）VARCHAR的长度只分配真正需要的空间；</li>
<li>3）使用枚举或整数代替字符串类型；</li>
<li>4）尽量使用TIMESTAMP而非DATETIME；</li>
<li>5）单表不要有太多字段，建议在20以内；</li>
<li>6）避免使用NULL字段，很难查询优化且占用额外索引空间；</li>
<li>7）用整型来存IP。</li>
</ul>
<h3 id="3-2-“索引”优化总结"><a href="#3-2-“索引”优化总结" class="headerlink" title="3.2 “索引”优化总结"></a>3.2 “索引”优化总结</h3><ul>
<li>1）索引并不是越多越好，要根据查询有针对性的创建，考虑在WHERE和ORDER BY命令上涉及的列建立索引，可根据EXPLAIN来查看是否用了索引还是全表扫描；</li>
<li>2）应尽量避免在WHERE子句中对字段进行NULL值判断，否则将导致引擎放弃使用索引而进行全表扫描。</li>
<li>3）值分布很稀少的字段不适合建索引，例如”性别”这种只有两三个值的字段。</li>
<li>4）字符字段只建前缀索引。</li>
<li>5）字符字段最好不要做主键。</li>
<li>6）不用外键，由程序保证约束。</li>
<li>7）尽量不用UNIQUE，由程序保证约束。</li>
<li>8）使用多列索引时主意顺序和查询条件保持一致，同时删除不必要的单列索引。</li>
</ul>
<h3 id="3-3-“查询SQL”优化总结"><a href="#3-3-“查询SQL”优化总结" class="headerlink" title="3.3 “查询SQL”优化总结"></a>3.3 “查询SQL”优化总结</h3><ul>
<li>1）可通过开启慢查询日志来找出较慢的SQL；</li>
<li>2）不做列运算：SELECT id WHERE age + 1 = 10，任何对列的操作都将导致表扫描，它包括数据库教程函数、计算表达式等等，查询时要尽可能将操作移至等号右边；</li>
<li>3）sql语句尽可能简单：一条sql只能在一个cpu运算；大语句拆小语句，减少锁时间；一条大sql可以堵死整个库；</li>
<li>4）不用SELECT *；</li>
<li>5）OR改写成IN：OR的效率是n级别，IN的效率是log(n)级别，in的个数建议控制在200以内；</li>
<li>6）不用函数和触发器，在应用程序实现；</li>
<li>7）避免%xxx式查询；</li>
<li>8）少用JOIN；</li>
<li>9）使用同类型进行比较，比如用’123’和’123’比，123和123比；</li>
<li>10）尽量避免在WHERE子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描；</li>
<li>11）对于连续数值，使用BETWEEN不用IN：SELECT id FROM t WHERE num BETWEEN 1 AND 5；</li>
<li>12）列表数据不要拿全表，要使用LIMIT来分页，每页数量也不要太大。</li>
</ul>
<h3 id="3-4-“引擎”的选择"><a href="#3-4-“引擎”的选择" class="headerlink" title="3.4 “引擎”的选择"></a>3.4 “引擎”的选择</h3><p>目前广泛使用的是MyISAM和InnoDB两种引擎。<br><strong><em>【MyISAM】：\</em></strong><br><strong>MyISAM引擎是MySQL 5.1及之前版本的默认引擎，它的特点是：</strong></p>
<ul>
<li>1）不支持行锁，读取时对需要读到的所有表加锁，写入时则对表加排它锁；</li>
<li>2）不支持事务；</li>
<li>3）不支持外键；</li>
<li>4）不支持崩溃后的安全恢复；</li>
<li>5）在表有读取查询的同时，支持往表中插入新纪录；</li>
<li>6）支持BLOB和TEXT的前500个字符索引，支持全文索引；</li>
<li>7）支持延迟更新索引，极大提升写入性能；</li>
<li>8）对于不会进行修改的表，支持压缩表，极大减少磁盘空间占用。</li>
</ul>
<p><strong><em>【InnoDB】：</em></strong><br><strong>InnoDB在MySQL 5.5后成为默认索引，它的特点是：</strong></p>
<ul>
<li>1）支持行锁，采用MVCC来支持高并发；</li>
<li>2）支持事务；</li>
<li>3）支持外键；</li>
<li>4）支持崩溃后的安全恢复；</li>
<li>5）不支持全文索引。</li>
</ul>
<p>总体来讲，MyISAM适合SELECT密集型的表，而InnoDB适合INSERT和UPDATE密集型的表。</p>
<h3 id="3-5-系统调优参数"><a href="#3-5-系统调优参数" class="headerlink" title="3.5 系统调优参数"></a>3.5 系统调优参数</h3><p><strong>可以使用下面几个工具来做基准测试：</strong></p>
<ul>
<li><a href="https://github.com/akopytov/sysbench" target="_blank" rel="noopener">sysbench</a>：一个模块化，跨平台以及多线程的性能测试工具；</li>
<li><a href="https://github.com/tmcallaghan/iibench-mysql" target="_blank" rel="noopener">iibench-mysql</a>：基于 Java 的 MySQL/Percona/MariaDB 索引进行插入性能测试工具；</li>
<li><a href="https://github.com/Percona-Lab/tpcc-mysql" target="_blank" rel="noopener">tpcc-mysql</a>：Percona开发的TPC-C测试工具。</li>
</ul>
<p><strong>具体的调优参数内容较多，具体可参考官方文档，这里介绍一些比较重要的参数：</strong></p>
<ul>
<li>1）back_log：back_log值指出在MySQL暂时停止回答新请求之前的短时间内多少个请求可以被存在堆栈中。也就是说，如果MySql的连接数据达到max_connections时，新来的请求将会被存在堆栈中，以等待某一连接释放资源，该堆栈的数量即back_log，如果等待连接的数量超过back_log，将不被授予连接资源。可以从默认的50升至500；</li>
<li>2）wait_timeout：数据库连接闲置时间，闲置连接会占用内存资源。可以从默认的8小时减到半小时；</li>
<li>3）max_user_connection: 最大连接数，默认为0无上限，最好设一个合理上限；</li>
<li>4）thread_concurrency：并发线程数，设为CPU核数的两倍；</li>
<li>5）skip_name_resolve：禁止对外部连接进行DNS解析，消除DNS解析时间，但需要所有远程主机用IP访问；</li>
<li>6）key_buffer_size：索引块的缓存大小，增加会提升索引处理速度，对MyISAM表性能影响最大。对于内存4G左右，可设为256M或384M，通过查询show status like ‘key_read%’，保证key_reads / key_read_requests在0.1%以下最好；</li>
<li>7）innodb_buffer_pool_size：缓存数据块和索引块，对InnoDB表性能影响最大。通过查询show status like ‘Innodb_buffer_pool_read%’，保证 (Innodb_buffer_pool_read_requests – Innodb_buffer_pool_reads) / Innodb_buffer_pool_read_requests越高越好；</li>
<li>8）innodb_additional_mem_pool_size：InnoDB存储引擎用来存放数据字典信息以及一些内部数据结构的内存空间大小，当数据库对象非常多的时候，适当调整该参数的大小以确保所有数据都能存放在内存中提高访问效率，当过小的时候，MySQL会记录Warning信息到数据库的错误日志中，这时就需要该调整这个参数大小；</li>
<li>9）innodb_log_buffer_size：InnoDB存储引擎的事务日志所使用的缓冲区，一般来说不建议超过32MB；</li>
<li>10）query_cache_size：缓存MySQL中的ResultSet，也就是一条SQL语句执行的结果集，所以仅仅只能针对select语句。当某个表的数据有任何任何变化，都会导致所有引用了该表的select语句在Query Cache中的缓存数据失效。所以，当我们的数据变化非常频繁的情况下，使用Query Cache可能会得不偿失。根据命中率(Qcache_hits/(Qcache_hits+Qcache_inserts)*100))进行调整，一般不建议太大，256MB可能已经差不多了，大型的配置型静态数据可适当调大；</li>
<li>11）可以通过命令show status like ‘Qcache_%’查看目前系统Query catch使用大小；</li>
<li>12）read_buffer_size：MySql读入缓冲区大小。对表进行顺序扫描的请求将分配一个读入缓冲区，MySql会为它分配一段内存缓冲区。如果对表的顺序扫描请求非常频繁，可以通过增加该变量值以及内存缓冲区大小提高其性能；</li>
<li>13）sort_buffer_size：MySql执行排序使用的缓冲大小。如果想要增加ORDER BY的速度，首先看是否可以让MySQL使用索引而不是额外的排序阶段。如果不能，可以尝试增加sort_buffer_size变量的大小；</li>
<li>14）read_rnd_buffer_size：MySql的随机读缓冲区大小。当按任意顺序读取行时(例如，按照排序顺序)，将分配一个随机读缓存区。进行排序查询时，MySql会首先扫描一遍该缓冲，以避免磁盘搜索，提高查询速度，如果需要排序大量数据，可适当调高该值。但MySql会为每个客户连接发放该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大；</li>
<li>15）record_buffer：每个进行一个顺序扫描的线程为其扫描的每张表分配这个大小的一个缓冲区。如果你做很多顺序扫描，可能想要增加该值；</li>
<li>16）thread_cache_size：保存当前没有与连接关联但是准备为后面新的连接服务的线程，可以快速响应连接的线程请求而无需创建新的；</li>
<li>17）table_cache：类似于thread_cache_size，但用来缓存表文件，对InnoDB效果不大，主要用于MyISAM。</li>
</ul>
<h3 id="3-6-升级硬件"><a href="#3-6-升级硬件" class="headerlink" title="3.6 升级硬件"></a>3.6 升级硬件</h3><p>Scale up，这个不多说了，根据MySQL是CPU密集型还是I/O密集型，通过提升CPU和内存、使用SSD，都能显著提升MySQL性能。</p>
<h2 id="4、读写分离"><a href="#4、读写分离" class="headerlink" title="4、读写分离"></a>4、读写分离</h2><p>也是目前常用的优化，从库读主库写，一般不要采用双主或多主引入很多复杂性，尽量采用文中的其他方案来提高性能。同时目前很多拆分的解决方案同时也兼顾考虑了读写分离</p>
<h2 id="5、缓存"><a href="#5、缓存" class="headerlink" title="5、缓存"></a>5、缓存</h2><p><strong>缓存可以发生在这些层次：</strong></p>
<ul>
<li>1）MySQL内部：在系统调优参数介绍了相关设置；</li>
<li>2）数据访问层：比如MyBatis针对SQL语句做缓存，而Hibernate可以精确到单个记录，这里缓存的对象主要是持久化对象Persistence Object；</li>
<li>3）应用服务层：这里可以通过编程手段对缓存做到更精准的控制和更多的实现策略，这里缓存的对象是数据传输对象Data Transfer Object；</li>
<li>4）Web层：针对web页面做缓存；</li>
<li>5）浏览器客户端：用户端的缓存。</li>
</ul>
<p>可以根据实际情况在一个层次或多个层次结合加入缓存。<br><strong>这里重点介绍下服务层的缓存实现，目前主要有两种方式：</strong></p>
<ul>
<li><strong>1）直写式（Write Through）：</strong>在数据写入数据库后，同时更新缓存，维持数据库与缓存的一致性。这也是当前大多数应用缓存框架如Spring Cache的工作方式。这种实现非常简单，同步好，但效率一般；</li>
<li><strong>2）回写式（Write Back）：</strong>当有数据要写入数据库时，只会更新缓存，然后异步批量的将缓存数据同步到数据库上。这种实现比较复杂，需要较多的应用逻辑，同时可能会产生数据库与缓存的不同步，但效率非常高。</li>
</ul>
<h2 id="6、表分区"><a href="#6、表分区" class="headerlink" title="6、表分区"></a>6、表分区</h2><p>MySQL在5.1版引入的分区是一种简单的水平拆分，用户需要在建表的时候加上分区参数，对应用是透明的无需修改代码。<br>对用户来说，分区表是一个独立的逻辑表，但是底层由多个物理子表组成，实现分区的代码实际上是通过对一组底层表的对象封装，但对SQL层来说是一个完全封装底层的黑盒子。MySQL实现分区的方式也意味着索引也是按照分区的子表定义，没有全局索引<br><img src="http://image.winrains.cn/2019/09/ce654-200643flfcaqz8u8llsbtf.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_8.png"><br>用户的SQL语句是需要针对分区表做优化，SQL条件中要带上分区条件的列，从而使查询定位到少量的分区上，否则就会扫描全部分区，可以通过EXPLAIN PARTITIONS来查看某条SQL语句会落在那些分区上，从而进行SQL优化，如下图5条记录落在两个分区上：</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">mysql&gt; explain partitions select count<span class="params">(1)</span> from user_partition where id in <span class="params">(1,2,3,4,5)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">+<span class="params">----</span>+<span class="params">-------------</span>+<span class="params">----------------</span>+<span class="params">------------</span>+<span class="params">-------</span>+<span class="params">---------------</span>+<span class="params">---------</span>+<span class="params">---------</span>+<span class="params">------</span>+<span class="params">------</span>+<span class="params">--------------------------</span>+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">| id | select_type | table          | partitions | type  | possible_keys | key     | key_len | ref  | rows | Extra                    |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">+<span class="params">----</span>+<span class="params">-------------</span>+<span class="params">----------------</span>+<span class="params">------------</span>+<span class="params">-------</span>+<span class="params">---------------</span>+<span class="params">---------</span>+<span class="params">---------</span>+<span class="params">------</span>+<span class="params">------</span>+<span class="params">--------------------------</span>+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|  1 | SIMPLE      | user_partition | p1,p4      | range | PRIMARY       | PRIMARY | 8       | NULL |    5 | Using where; Using index |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">+<span class="params">----</span>+<span class="params">-------------</span>+<span class="params">----------------</span>+<span class="params">------------</span>+<span class="params">-------</span>+<span class="params">---------------</span>+<span class="params">---------</span>+<span class="params">---------</span>+<span class="params">------</span>+<span class="params">------</span>+<span class="params">--------------------------</span>+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">1 row in <span class="keyword">set</span> <span class="params">(0.00 sec)</span></span></pre></td></tr></table></figure>

<p><strong>分区的好处是：</strong></p>
<ul>
<li>1）可以让单表存储更多的数据；</li>
<li>2）分区表的数据更容易维护，可以通过清楚整个分区批量删除大量数据，也可以增加新的分区来支持新插入的数据。另外，还可以对一个独立分区进行优化、检查、修复等操作；</li>
<li>3）部分查询能够从查询条件确定只落在少数分区上，速度会很快；</li>
<li>4）分区表的数据还可以分布在不同的物理设备上，从而搞笑利用多个硬件设备；</li>
<li>5）可以使用分区表赖避免某些特殊瓶颈，例如InnoDB单个索引的互斥访问、ext3文件系统的inode锁竞争；</li>
<li>6）可以备份和恢复单个分区。</li>
</ul>
<p><strong>分区的限制和缺点：</strong></p>
<ul>
<li>1）一个表最多只能有1024个分区；</li>
<li>2）如果分区字段中有主键或者唯一索引的列，那么所有主键列和唯一索引列都必须包含进来；</li>
<li>3）分区表无法使用外键约束；</li>
<li>4）NULL值会使分区过滤无效；</li>
<li>5）所有分区必须使用相同的存储引擎。</li>
</ul>
<p><strong>分区的类型：</strong></p>
<ul>
<li>1）RANGE分区：基于属于一个给定连续区间的列值，把多行分配给分区；</li>
<li>2）LIST分区：类似于按RANGE分区，区别在于LIST分区是基于列值匹配一个离散值集合中的某个值来进行选择；</li>
<li>3）HASH分区：基于用户定义的表达式的返回值来进行选择的分区，该表达式使用将要插入到表中的这些行的列值进行计算。这个函数可以包含MySQL中有效的、产生非负整数值的任何表达式；</li>
<li>4）KEY分区：类似于按HASH分区，区别在于KEY分区只支持计算一列或多列，且MySQL服务器提供其自身的哈希函数。必须有一列或多列包含整数值。</li>
</ul>
<p><strong>分区最适合的场景数据的时间序列性比较强，则可以按时间来分区，如下所示：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> members (</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    firstname <span class="built_in">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    lastname <span class="built_in">VARCHAR</span>(<span class="number">25</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    username <span class="built_in">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    email <span class="built_in">VARCHAR</span>(<span class="number">35</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    joined <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>( <span class="keyword">YEAR</span>(joined) ) (</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">PARTITION</span> p0 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">1960</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">PARTITION</span> p1 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">1970</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">PARTITION</span> p2 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">1980</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">PARTITION</span> p3 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> (<span class="number">1990</span>),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">PARTITION</span> p4 <span class="keyword">VALUES</span> <span class="keyword">LESS</span> <span class="keyword">THAN</span> MAXVALUE</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">);</span></pre></td></tr></table></figure>

<p>查询时加上时间范围条件效率会非常高，同时对于不需要的历史数据能很容的批量删除。<br>如果数据有明显的热点，而且除了这部分数据，其他数据很少被访问到，那么可以将热点数据单独放在一个分区，让这个分区的数据能够有机会都缓存在内存中，查询时只访问一个很小的分区表，能够有效使用索引和缓存。<br>另外MySQL有一种早期的简单的分区实现 - 合并表（merge table），限制较多且缺乏优化，不建议使用，应该用新的分区机制来替代。</p>
<h2 id="7、垂直拆分"><a href="#7、垂直拆分" class="headerlink" title="7、垂直拆分"></a>7、垂直拆分</h2><p>垂直分库是根据数据库里面的数据表的相关性进行拆分，比如：一个数据库里面既存在用户数据，又存在订单数据，那么垂直拆分可以把用户数据放到用户库、把订单数据放到订单库。垂直分表是对数据表进行垂直拆分的一种方式，常见的是把一个多字段的大表按常用字段和非常用字段进行拆分，每个表里面的数据记录数一般情况下是相同的，只是字段不一样，使用主键关联。<br><strong>比如原始的用户表是：</strong><br><img src="http://image.winrains.cn/2019/09/523fb-201848i2jjd2rt2em4rto2.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_9.png"><br><strong>垂直拆分后是：</strong><br><img src="http://image.winrains.cn/2019/09/a087f-201904wzma8arsmyxxpqyy.jpg" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_10.jpg"><br><strong>垂直拆分的优点是：</strong></p>
<ul>
<li>1）可以使得行数据变小，一个数据块(Block)就能存放更多的数据，在查询时就会减少I/O次数(每次查询时读取的Block 就少)；</li>
<li>2）可以达到最大化利用Cache的目的，具体在垂直拆分的时候可以将不常变的字段放一起，将经常改变的放一起；</li>
<li>3）数据维护简单。</li>
</ul>
<p><strong>缺点是：</strong></p>
<ul>
<li>1）主键出现冗余，需要管理冗余列；</li>
<li>2）会引起表连接JOIN操作（增加CPU开销）可以通过在业务服务器上进行join来减少数据库压力；</li>
<li>3）依然存在单表数据量过大的问题（需要水平拆分）；</li>
<li>4）事务处理复杂。</li>
</ul>
<h2 id="8、水平拆分"><a href="#8、水平拆分" class="headerlink" title="8、水平拆分"></a>8、水平拆分</h2><h3 id="8-1-概述"><a href="#8-1-概述" class="headerlink" title="8.1 概述"></a>8.1 概述</h3><p>水平拆分是通过某种策略将数据分片来存储，分库内分表和分库两部分，每片数据会分散到不同的MySQL表或库，达到分布式的效果，能够支持非常大的数据量。前面的表分区本质上也是一种特殊的库内分表。<br>库内分表，仅仅是单纯的解决了单一表数据过大的问题，由于没有把表的数据分布到不同的机器上，因此对于减轻MySQL服务器的压力来说，并没有太大的作用，大家还是竞争同一个物理机上的IO、CPU、网络，这个就要通过分库来解决。<br><strong>前面垂直拆分的用户表如果进行水平拆分，结果是：</strong><br><img src="http://image.winrains.cn/2019/09/d5560-202453wvpnf0441z89yyy9.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_11.png"><br>实际情况中往往会是垂直拆分和水平拆分的结合，即将Users_A_M和Users_N_Z再拆成Users和UserExtras，这样一共四张表。<br><strong>水平拆分的优点是:</strong></p>
<ul>
<li>1）不存在单库大数据和高并发的性能瓶颈；</li>
<li>2）应用端改造较少；</li>
<li>3）提高了系统的稳定性和负载能力。</li>
</ul>
<p><strong>缺点是：</strong></p>
<ul>
<li>1）分片事务一致性难以解决；</li>
<li>2）跨节点Join性能差，逻辑复杂；</li>
<li>3）数据多次扩展难度跟维护量极大。</li>
</ul>
<h3 id="8-2-分片原则"><a href="#8-2-分片原则" class="headerlink" title="8.2 分片原则"></a>8.2 分片原则</h3><ul>
<li>1）能不分就不分，参考“单表优化”；</li>
<li>2）分片数量尽量少，分片尽量均匀分布在多个数据结点上，因为一个查询SQL跨分片越多，则总体性能越差，虽然要好于所有数据在一个分片的结果，只在必要的时候进行扩容，增加分片数量；</li>
<li>3）分片规则需要慎重选择做好提前规划，分片规则的选择，需要考虑数据的增长模式，数据的访问模式，分片关联性问题，以及分片扩容问题，最近的分片策略为范围分片，枚举分片，一致性Hash分片，这几种分片都有利于扩容；</li>
<li>4）尽量不要在一个事务中的SQL跨越多个分片，分布式事务一直是个不好处理的问题；</li>
<li>5）查询条件尽量优化，尽量避免Select * 的方式，大量数据结果集下，会消耗大量带宽和CPU资源，查询尽量避免返回大量结果集，并且尽量为频繁使用的查询语句建立索引；</li>
<li>6）通过数据冗余和表分区赖降低跨库Join的可能。</li>
</ul>
<p>这里特别强调一下分片规则的选择问题，如果某个表的数据有明显的时间特征，比如订单、交易记录等，则他们通常比较合适用时间范围分片，因为具有时效性的数据，我们往往关注其近期的数据，查询条件中往往带有时间字段进行过滤，比较好的方案是，当前活跃的数据，采用跨度比较短的时间段进行分片，而历史性的数据，则采用比较长的跨度存储。<br>总体上来说，分片的选择是取决于最频繁的查询SQL的条件，因为不带任何Where语句的查询SQL，会遍历所有的分片，性能相对最差，因此这种SQL越多，对系统的影响越大，所以我们要尽量避免这种SQL的产生。</p>
<h3 id="8-3-解决方案"><a href="#8-3-解决方案" class="headerlink" title="8.3 解决方案"></a>8.3 解决方案</h3><p>由于水平拆分牵涉的逻辑比较复杂，当前也有了不少比较成熟的解决方案。这些方案分为两大类：客户端架构和代理架构。<br><strong><em>【客户端架构】：\</em></strong><br>通过修改数据访问层，如JDBC、Data Source、MyBatis，通过配置来管理多个数据源，直连数据库，并在模块内完成数据的分片整合，一般以Jar包的方式呈现。<br>这是一个客户端架构的例子：<br><img src="http://image.winrains.cn/2019/09/3d704-203632sahtc790wc69isam.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_12.png"><br>可以看到分片的实现是和应用服务器在一起的，通过修改Spring JDBC层来实现<br>客户端架构的优点是：</p>
<ul>
<li>1）应用直连数据库，降低外围系统依赖所带来的宕机风险；</li>
<li>2）集成成本低，无需额外运维的组件。</li>
</ul>
<p>缺点是：</p>
<ul>
<li>1）限于只能在数据库访问层上做文章，扩展性一般，对于比较复杂的系统可能会力不从心；</li>
<li>2）将分片逻辑的压力放在应用服务器上，造成额外风险。</li>
</ul>
<p><strong><em>【代理架构】：\</em></strong><br>通过独立的中间件来统一管理所有数据源和数据分片整合，后端数据库集群对前端应用程序透明，需要独立部署和运维代理组件。<br>这是一个代理架构的例子：<br><img src="http://image.winrains.cn/2019/09/18b3e-203750rv4cvxcvvdxumgux.png" alt="优秀后端架构师必会知识：史上最全MySQL大表优化方案总结_13.png"><br>代理组件为了分流和防止单点，一般以集群形式存在，同时可能需要Zookeeper之类的服务组件来管理。<br>代理架构的优点是：</p>
<ul>
<li>能够处理非常复杂的需求，不受数据库访问层原来实现的限制，扩展性强；</li>
<li>对于应用服务器透明且没有增加任何额外负载。</li>
</ul>
<p>缺点是：</p>
<ul>
<li>需部署和运维独立的代理中间件，成本高；</li>
<li>应用需经过代理来连接数据库，网络上多了一跳，性能有损失且有额外风险。</li>
</ul>
<h3 id="8-4-各方案比较"><a href="#8-4-各方案比较" class="headerlink" title="8.4 各方案比较"></a>8.4 各方案比较</h3><table>
<thead>
<tr>
<th></th>
<th><strong>出品方</strong></th>
<th><strong>架构模型</strong></th>
<th><strong>支持数据库</strong></th>
<th><strong>分库</strong></th>
<th><strong>分表</strong></th>
<th><strong>读写分离</strong></th>
<th><strong>外部依赖</strong></th>
<th><strong>是否开源</strong></th>
<th><strong>实现语言</strong></th>
<th><strong>支持语言</strong></th>
<th><strong>最后更新</strong></th>
<th><strong>Github星数</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong><a href="https://www.mysql.com/products/enterprise/fabric.html" target="_blank" rel="noopener">MySQL Fabric</a></strong></td>
<td>MySQL官方</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>python</td>
<td>无限制</td>
<td>4个月前</td>
<td>35</td>
</tr>
<tr>
<td><strong><a href="https://github.com/alibaba/cobar" target="_blank" rel="noopener">Cobar</a></strong></td>
<td>阿里巴巴</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>无限制</td>
<td>两年前</td>
<td>1287</td>
</tr>
<tr>
<td><strong><a href="https://github.com/alibaba/cobarclient" target="_blank" rel="noopener">Cobar Client</a></strong></td>
<td>阿里巴巴</td>
<td>客户端架构</td>
<td>MySQL</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>Java</td>
<td>三年前</td>
<td>344</td>
</tr>
<tr>
<td><strong><a href="https://github.com/alibaba/tb_tddl" target="_blank" rel="noopener">TDDL</a></strong></td>
<td>淘宝</td>
<td>客户端架构</td>
<td>无限制</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>Diamond</td>
<td>只开源部分</td>
<td>Java</td>
<td>Java</td>
<td>未知</td>
<td>519</td>
</tr>
<tr>
<td><strong><a href="https://github.com/Qihoo360/Atlas" target="_blank" rel="noopener">Atlas</a></strong></td>
<td>奇虎360</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>C</td>
<td>无限制</td>
<td>10个月前</td>
<td>1941</td>
</tr>
<tr>
<td><strong><a href="https://github.com/brucexx/heisenberg" target="_blank" rel="noopener">Heisenberg</a></strong></td>
<td>百度熊照</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>无限制</td>
<td>2个月前</td>
<td>197</td>
</tr>
<tr>
<td><strong><a href="https://github.com/jojoin/TribeDB" target="_blank" rel="noopener">TribeDB</a></strong></td>
<td>个人</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>NodeJS</td>
<td>无限制</td>
<td>3个月前</td>
<td>126</td>
</tr>
<tr>
<td><strong><a href="https://github.com/dangdangdotcom/sharding-jdbc" target="_blank" rel="noopener">ShardingJDBC</a></strong></td>
<td>当当</td>
<td>客户端架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>Java</td>
<td>当天</td>
<td>1144</td>
</tr>
<tr>
<td><strong><a href="https://github.com/gaoxianglong/shark" target="_blank" rel="noopener">Shark</a></strong></td>
<td>个人</td>
<td>客户端架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>Java</td>
<td>两天前</td>
<td>84</td>
</tr>
<tr>
<td><strong><a href="https://github.com/flike/kingshard" target="_blank" rel="noopener">KingShard</a></strong></td>
<td>个人</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>Golang</td>
<td>无限制</td>
<td>两天前</td>
<td>1836</td>
</tr>
<tr>
<td><strong><a href="http://www.onexsoft.com/?page_id=3383" target="_blank" rel="noopener">OneProxy</a></strong></td>
<td>平民软件</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>否</td>
<td>未知</td>
<td>无限制</td>
<td>未知</td>
<td>未知</td>
</tr>
<tr>
<td><strong><a href="http://mycat.io/" target="_blank" rel="noopener">MyCat</a></strong></td>
<td>社区</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>无限制</td>
<td>两天前</td>
<td>1270</td>
</tr>
<tr>
<td><strong><a href="https://github.com/youtube/vitess" target="_blank" rel="noopener">Vitess</a></strong></td>
<td>Youtube</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>是</td>
<td>Golang</td>
<td>无限制</td>
<td>当天</td>
<td>3636</td>
</tr>
<tr>
<td><strong><a href="https://github.com/siddontang/mixer" target="_blank" rel="noopener">Mixer</a></strong></td>
<td>个人</td>
<td>代理架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Golang</td>
<td>无限制</td>
<td>9个月前</td>
<td>472</td>
</tr>
<tr>
<td><strong><a href="https://github.com/tumblr/jetpants" target="_blank" rel="noopener">JetPants</a></strong></td>
<td>Tumblr</td>
<td>客户端架构</td>
<td>MySQL</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Ruby</td>
<td>Ruby</td>
<td>10个月前</td>
<td>957</td>
</tr>
<tr>
<td><strong><a href="https://github.com/hibernate/hibernate-shards" target="_blank" rel="noopener">HibernateShard</a></strong></td>
<td>Hibernate</td>
<td>客户端架构</td>
<td>无限制</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>Java</td>
<td>4年前</td>
<td>57</td>
</tr>
<tr>
<td><strong><a href="https://github.com/makersoft/mybatis-shards" target="_blank" rel="noopener">MybatisShard</a></strong></td>
<td>MakerSoft</td>
<td>客户端架构</td>
<td>无限制</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>Java</td>
<td>11个月前</td>
<td>119</td>
</tr>
<tr>
<td><strong><a href="https://github.com/twitter/gizzard" target="_blank" rel="noopener">Gizzard</a></strong></td>
<td>Twitter</td>
<td>代理架构</td>
<td>无限制</td>
<td>有</td>
<td>有</td>
<td>无</td>
<td>无</td>
<td>是</td>
<td>Java</td>
<td>无限制</td>
<td>3年前</td>
<td>2087</td>
</tr>
</tbody></table>
<p><strong>如此多的方案，如何进行选择？可以按以下思路来考虑：</strong></p>
<ul>
<li>1）确定是使用代理架构还是客户端架构。中小型规模或是比较简单的场景倾向于选择客户端架构，复杂场景或大规模系统倾向选择代理架构；</li>
<li>2）具体功能是否满足，比如需要跨节点ORDER BY，那么支持该功能的优先考虑；</li>
<li>3）不考虑一年内没有更新的产品，说明开发停滞，甚至无人维护和技术支持；</li>
<li>4）最好按大公司-&gt;社区-&gt;小公司-&gt;个人这样的出品方顺序来选择；</li>
<li>5）选择口碑较好的，比如github星数、使用者数量质量和使用者反馈；</li>
<li>6）开源的优先，往往项目有特殊需求可能需要改动源代码。</li>
</ul>
<p><strong>按照上述思路，推荐以下选择：</strong></p>
<ul>
<li>1）客户端架构：ShardingJDBC；</li>
<li>2）代理架构：MyCat或者Atlas。</li>
</ul>
<h2 id="9、兼容MySQL且可水平扩展的数据库"><a href="#9、兼容MySQL且可水平扩展的数据库" class="headerlink" title="9、兼容MySQL且可水平扩展的数据库"></a>9、兼容MySQL且可水平扩展的数据库</h2><p><strong>目前也有一些开源数据库兼容MySQL协议，如：</strong></p>
<ul>
<li>1）<a href="https://github.com/pingcap/tidb" target="_blank" rel="noopener">TiDB</a>；</li>
<li>2）<a href="http://www.cubrid.org/" target="_blank" rel="noopener">Cubrid</a>。</li>
</ul>
<p>但其工业品质和MySQL尚有差距，且需要较大的运维投入。<br><strong>如果想将原始的MySQL迁移到可水平扩展的新数据库中，可以考虑一些云数据库：</strong></p>
<ul>
<li>1）阿里云<a href="https://cn.aliyun.com/product/petadata/?spm=5176.7960203.237031.38.cAzx5r" target="_blank" rel="noopener">PetaData</a>；</li>
<li>2）阿里云<a href="https://cn.aliyun.com/product/oceanbase?spm=5176.7960203.237031.40.cAzx5r" target="_blank" rel="noopener">OceanBase</a>；</li>
<li>3）腾讯云<a href="https://cloud.tencent.com/product/dcdb_for_tdsql" target="_blank" rel="noopener">DCDB</a>。</li>
</ul>
<h2 id="10、NoSQL"><a href="#10、NoSQL" class="headerlink" title="10、NoSQL"></a>10、NoSQL</h2><p>在MySQL上做Sharding是一种戴着镣铐的跳舞，事实上很多大表本身对MySQL这种RDBMS的需求并不大，并不要求ACID，可以考虑将这些表迁移到NoSQL，彻底解决水平扩展问题。<br><strong>例如：</strong></p>
<ul>
<li>1）日志类、监控类、统计类数据；</li>
<li>2）非结构化或弱结构化数据；</li>
<li>3）对事务要求不强，且无太多关联操作的数据。</li>
</ul>
<blockquote>
<p>作者：JackJiang</p>
<p>来源：<a href="http://www.52im.net/thread-2157-1-1.html" target="_blank" rel="noopener">http://www.52im.net/thread-2157-1-1.html</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/12/27/%E8%A7%A3%E5%AF%86%E5%B0%8F%E7%B1%B3%E6%8A%A2%E8%B4%AD%E7%B3%BB%E7%BB%9F%E5%8D%83%E4%B8%87%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E8%BF%9B%E5%92%8C%E5%AE%9E%E8%B7%B5/" rel="prev" title="解密小米抢购系统千万高并发架构的演进和实践">
      <i class="fa fa-chevron-left"></i> 解密小米抢购系统千万高并发架构的演进和实践
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/12/27/%E8%BE%BE%E8%BE%BEO2O%E5%90%8E%E5%8F%B0%E6%9E%B6%E6%9E%84%E6%BC%94%E8%BF%9B%E5%AE%9E%E8%B7%B5/" rel="next" title="达达O2O后台架构演进实践">
      达达O2O后台架构演进实践 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、引言"><span class="nav-number">1.</span> <span class="nav-text">1、引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、关于MySQL"><span class="nav-number">2.</span> <span class="nav-text">2、关于MySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-MySQL之父"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 MySQL之父</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-MySQL历史"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 MySQL历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-MySQL大事记"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 MySQL大事记</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-MySQL现状及应用"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 MySQL现状及应用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、MySQL的单表优化干货总结"><span class="nav-number">3.</span> <span class="nav-text">3、MySQL的单表优化干货总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-“字段”优化总结"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 “字段”优化总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-“索引”优化总结"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 “索引”优化总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-“查询SQL”优化总结"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 “查询SQL”优化总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-“引擎”的选择"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 “引擎”的选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-系统调优参数"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 系统调优参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-升级硬件"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 升级硬件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、读写分离"><span class="nav-number">4.</span> <span class="nav-text">4、读写分离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、缓存"><span class="nav-number">5.</span> <span class="nav-text">5、缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、表分区"><span class="nav-number">6.</span> <span class="nav-text">6、表分区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、垂直拆分"><span class="nav-number">7.</span> <span class="nav-text">7、垂直拆分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8、水平拆分"><span class="nav-number">8.</span> <span class="nav-text">8、水平拆分</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-概述"><span class="nav-number">8.1.</span> <span class="nav-text">8.1 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-分片原则"><span class="nav-number">8.2.</span> <span class="nav-text">8.2 分片原则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-解决方案"><span class="nav-number">8.3.</span> <span class="nav-text">8.3 解决方案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-各方案比较"><span class="nav-number">8.4.</span> <span class="nav-text">8.4 各方案比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9、兼容MySQL且可水平扩展的数据库"><span class="nav-number">9.</span> <span class="nav-text">9、兼容MySQL且可水平扩展的数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10、NoSQL"><span class="nav-number">10.</span> <span class="nav-text">10、NoSQL</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">congsheng.wang</p>
  <div class="site-description" itemprop="description">trouble is a friend</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">807</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">91</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">141</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">congsheng.wang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
