<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://congsheng.wang').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="7 管理 虽然小白的博客已经运行有一段时间了，可是小白对如何管理Redis依然完全没有概念。比如他知道Redis将所有的数据都存储在内存中，那么如果服务器重启了，Redis中的数据怎么恢复呢？又如怎样给Redis设置密码以防其他未经授权的客户端连接呢？带着这些疑惑，小白再一次找到了宋老师。  本章将会讲解Redis的管理知识，包括持久化、复制和安全内容，同时还会介绍一些第三方的Redis管理工具。">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis使用教程（6）：管理">
<meta property="og:url" content="http:&#x2F;&#x2F;congsheng.wang&#x2F;2019&#x2F;12&#x2F;29&#x2F;Redis%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%886%EF%BC%89%EF%BC%9A%E7%AE%A1%E7%90%86&#x2F;index.html">
<meta property="og:site_name" content="congsheng的博客">
<meta property="og:description" content="7 管理 虽然小白的博客已经运行有一段时间了，可是小白对如何管理Redis依然完全没有概念。比如他知道Redis将所有的数据都存储在内存中，那么如果服务器重启了，Redis中的数据怎么恢复呢？又如怎样给Redis设置密码以防其他未经授权的客户端连接呢？带着这些疑惑，小白再一次找到了宋老师。  本章将会讲解Redis的管理知识，包括持久化、复制和安全内容，同时还会介绍一些第三方的Redis管理工具。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;10&#x2F;665aa-1458312651066088899.png">
<meta property="og:updated_time" content="2019-12-29T14:32:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;10&#x2F;665aa-1458312651066088899.png">

<link rel="canonical" href="http://congsheng.wang/2019/12/29/Redis%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%886%EF%BC%89%EF%BC%9A%E7%AE%A1%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>Redis使用教程（6）：管理 | congsheng的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">congsheng的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">欢迎访问：winrains.cn</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">156</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">94</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">984</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://congsheng.wang/2019/12/29/Redis%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%886%EF%BC%89%EF%BC%9A%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="congsheng.wang">
      <meta itemprop="description" content="trouble is a friend">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="congsheng的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis使用教程（6）：管理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-12-29 22:32:37" itemprop="dateCreated datePublished" datetime="2019-12-29T22:32:37+08:00">2019-12-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">Java技术</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E6%8A%80%E6%9C%AF/Redis/" itemprop="url" rel="index">
                    <span itemprop="name">Redis</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="7-管理"><a href="#7-管理" class="headerlink" title="7 管理"></a>7 管理</h1><blockquote>
<p>虽然小白的博客已经运行有一段时间了，可是小白对如何管理Redis依然完全没有概念。比如他知道Redis将所有的数据都存储在内存中，那么如果服务器重启了，Redis中的数据怎么恢复呢？又如怎样给Redis设置密码以防其他未经授权的客户端连接呢？带着这些疑惑，小白再一次找到了宋老师。</p>
</blockquote>
<p>本章将会讲解Redis的管理知识，包括持久化、复制和安全内容，同时还会介绍一些第三方的Redis管理工具。</p>
<a id="more"></a>

<h2 id="7-3-安全"><a href="#7-3-安全" class="headerlink" title="7.3 安全"></a>7.3 安全</h2><p>Redis的作者Salvatore Sanfilippo曾经发表过Redis宣言 ，其中提到Redis以简洁为美。同样在安全层面Redis也没有做太多的工作。</p>
<h3 id="7-3-1-可信的环境"><a href="#7-3-1-可信的环境" class="headerlink" title="7.3.1 可信的环境"></a><strong>7.3.1 可信的环境</strong></h3><p>Redis的安全设计是在“Redis运行在可信环境”这个前提下做出的，在生产环境运行时不能允许外界直接连接到Redis服务器上，而应该通过应用程序进行中转，运行在可信的环境中是保证Redis安全的最重要方法。<br>Redis的默认配置会接受来自任何地址发送来的请求，即在任何一个拥有公网IP的服务器上启动Redis服务器，都可以被外界直接访问到。要更改这一设置，在配置文件中修改<code>bind</code>参数，如只允许本机应用连接Redis，可以将bind参数改成：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span></pre></td></tr></table></figure>

<p>2.8版本之前，bind参数只能绑定一个地址 ，如果想更自由地设置访问规则需要通过防火墙来完成。</p>
<h3 id="7-3-2-数据库密码"><a href="#7-3-2-数据库密码" class="headerlink" title="7.3.2 数据库密码"></a><strong>7.3.2 数据库密码</strong></h3><p>除此之外，还可以通过配置文件中的<code>requirepass</code>参数为Redis设置一个密码。例如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">requirepass</span> <span class="selector-tag">TAFK</span>(@~!<span class="keyword">ji</span>^<span class="keyword">XALQ</span>(<span class="keyword">sYh5xIwTn5D</span> s7JF</span></pre></td></tr></table></figure>

<p>客户端每次连接到Redis时都需要发送密码，否则Redis会拒绝执行客户端发来的命令。例如：</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis&gt; <span class="keyword">GET</span> foo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">(<span class="keyword">error</span>) <span class="built_in">ERR</span> operation <span class="keyword">not</span> permitted</span></pre></td></tr></table></figure>

<p>发送密码需要使用AUTH命令，就像这样：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">redis</span>&gt; <span class="selector-tag">AUTH</span> <span class="selector-tag">TAFK</span>(@~!<span class="keyword">ji</span>^<span class="keyword">XALQ</span>(<span class="keyword">sYh5xIwTn5D</span> s7JF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">OK</span></pre></td></tr></table></figure>

<p>之后就可以执行任何命令了：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis&gt; <span class="builtin-name">GET</span> foo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">" 1"</span></span></pre></td></tr></table></figure>

<p>由于Redis的性能极高，并且输入错误密码后Redis并不会进行主动延迟（考虑到Redis的单线程模型），所以攻击者可以通过穷举法破解Redis的密码（1秒内能够尝试十几万个密码），因此在设置时一定要选择复杂的密码。<br><strong>提示</strong> 配置Redis复制的时候如果主数据库设置了密码，需要在从数据库的配置文件中通过<code>masterauth</code>参数设置主数据库的密码，以使从数据库连接主数据库时自动使用AUTH命令认证。</p>
<h3 id="7-3-3-命名命令"><a href="#7-3-3-命名命令" class="headerlink" title="7.3.3 命名命令"></a><strong>7.3.3 命名命令</strong></h3><p>Redis支持在配置文件中将命令重命名，比如将FLUSHALL命令重命名成一个比较复杂的名字，以保证只有自己的应用可以使用该命令。就像这样：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">rename</span>-<span class="keyword">command</span> <span class="title">FLUSHALL</span> <span class="title">oyfekmjvmwxq5a9c8usofuo369x0it2k</span></span></pre></td></tr></table></figure>

<p>如果希望直接禁用某个命令可以将命令重命名成空字符串：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">rename</span>-<span class="keyword">command</span> <span class="title">FLUSHALL</span> <span class="string">""</span></span></pre></td></tr></table></figure>

<p>注意 无论设置密码还是重命名命令，都需要保证配置文件的安全性，否则就没有任何意义了。</p>
<h2 id="7-4-通信协议"><a href="#7-4-通信协议" class="headerlink" title="7.4 通信协议"></a>7.4 通信协议</h2><p>Redis通信协议是Redis客户端与Redis之间交流的语言，通信协议规定了命令和返回值的格式。了解Redis通信协议后不仅可以理解AOF文件的格式和主从复制时主数据库向从数据库发送的内容等，还可以开发自己的Redis客户端（不过由于几乎所有常用的语言都有相应的Redis客户端，需要使用通信协议直接和Redis打交道的机会确实不多）。<br>Redis支持两种通信协议，一种是二进制安全的统一请求协议（unified request protocol），一种是比较直观的便于在telnet程序中输入的简单协议。这两种协议只是命令的格式有区别，命令返回值的格式是一样的。</p>
<h3 id="7-4-1-简单协议"><a href="#7-4-1-简单协议" class="headerlink" title="7.4.1 简单协议"></a><strong>7.4.1 简单协议</strong></h3><p>简单协议适合在telnet程序中和Redis通信。简单协议的命令格式就是将命令和各个参数使用空格分隔开，如“EXISTS foo”、“SET foo bar”等。由于Redis解析简单协议时只是简单地以空格分隔参数，所以无法输入二进制字符。我们可以通过telnet程序测试：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">telnet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">6379</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">Trying <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">Connected to localhost.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Escape character <span class="keyword">is</span> <span class="string">'^]'</span>.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">SET foo bar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">+OK</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">GET foo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">$<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">bar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">LPUSH plist <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">:<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">LRANGE plist <span class="number">0</span> <span class="number">-1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">＊<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">$<span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">$<span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">$<span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">ERRORCOMMAND</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">-ERR unknown command <span class="string">'ERRORCOMMAND'</span></span></pre></td></tr></table></figure>

<p><strong>提示</strong> Redis 2.4之前的版本对于某些命令可以使用类似简单协议的特殊方式输入二进制安全的参数，例如：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">C:</span><span class="keyword">SET</span> foo <span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">C:</span>bar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">S:</span>+OK</span></pre></td></tr></table></figure>

<p>其中C:表示客户端发出的内容，S:表示服务端发出的内容。第一行的最后一个参数表示字符串的长度，第二行是字符串的实际内容，因为指定了长度，所以第二行的字符串可以包含二进制字符。但是这个协议已经废弃，被新的统一请求协议取代。“统一”二字指所有的命令使用同样的请求方式而不再为某些命令使用特殊方式，如果需要在参数中包含二进制字符应该使用7.4.2节介绍的统一请求协议。<br>我们在telnet程序中输入的5条命令恰好展示了Redis的5种返回值类型的格式，2.3.2节介绍了这5种返回值类型在redis-cli中的展现形式，这些展现形式是经过了redis-cli封装的，而上面的内容才是Redis真正返回的格式。下面分别介绍。<br>1．错误回复<br>错误回复（error reply）以-开头，并在后面跟上错误信息，最后以\r\n结尾：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">-ERR unknown <span class="keyword">command</span> <span class="string">'ERRORCOMMAND'</span>\<span class="title">r</span>\<span class="title">n</span></span></pre></td></tr></table></figure>

<p>2．状态回复<br>状态回复（status reply）以+开头，并在后面跟上状态信息，最后以\r\n结尾：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+OK<span class="symbol">\r</span><span class="symbol">\n</span></span></pre></td></tr></table></figure>

<p>3．整数回复<br>整数回复（integer reply）以:开头，并在后面跟上数字，最后以\r\n结尾：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">:3<span class="symbol">\r</span><span class="symbol">\n</span></span></pre></td></tr></table></figure>

<p>4．字符串回复<br>字符串回复（bulk reply）以 开头，并在后面跟上字符串的长度，并以\r\n分隔，接着是字符串的内容和\r\n：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$3<span class="symbol">\r</span><span class="symbol">\n</span>bar<span class="symbol">\r</span><span class="symbol">\n</span></span></pre></td></tr></table></figure>

<p>如果返回值是空结果nil，则会返回 -1以和空字符串相区别。<br>5．多行字符串回复<br>多行字符串回复（multi-bulk reply）以*开头，并在后面跟上字符串回复的组数，并以\r\n分隔。接着后面跟的就是字符串回复的具体内容了：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">*3<span class="symbol">\r</span><span class="symbol">\n</span> 1<span class="symbol">\r</span><span class="symbol">\n</span>3<span class="symbol">\r</span><span class="symbol">\n</span> 1<span class="symbol">\r</span><span class="symbol">\n</span>2<span class="symbol">\r</span><span class="symbol">\n</span> 1<span class="symbol">\r</span><span class="symbol">\n</span>1<span class="symbol">\r</span><span class="symbol">\n</span></span></pre></td></tr></table></figure>

<h3 id="7-4-2-统一请求协议"><a href="#7-4-2-统一请求协议" class="headerlink" title="7.4.2 统一请求协议"></a><strong>7.4.2 统一请求协议</strong></h3><p>统一请求协议是从Redis 1.2开始加入的，其命令格式和多行字符串回复的格式很类似，如SET foo bar的统一请求协议写法是“*3\r\n 3\r\nSET\r\n 3\r\nfoo\r\n 3\r\nbar\r\n”。还是使用telnet进行演示：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">telnet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">6379</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">Trying <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">Connected to localhost.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Escape character <span class="keyword">is</span> <span class="string">'^]'</span>.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">*<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">$<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">SET</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">$<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">foo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">$<span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">bar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">+OK</span></pre></td></tr></table></figure>

<p>同样发送命令时指定了后面字符串的长度，所以命令的每个参数都可以包含二进制的字符。统一请求协议的返回值格式和简单协议一样，这里不再赘述。<br>Redis的AOF文件和主从复制时主数据库向从数据库发送的内容都使用了统一请求协议。如果要开发一个和Redis直接通信的客户端，推荐使用此协议。如果只是想通过telnet向Redis服务器发送命令则使用简单协议就可以了。</p>
<h2 id="7-5-管理工具"><a href="#7-5-管理工具" class="headerlink" title="7.5 管理工具"></a>7.5 管理工具</h2><p>工欲善其事，必先利其器。在使用Redis的时候如果能够有效利用Redis的各种管理工具，将会大大方便开发和管理。</p>
<h3 id="7-5-1-redis-cli"><a href="#7-5-1-redis-cli" class="headerlink" title="7.5.1 redis-cli"></a><strong>7.5.1 redis-cli</strong></h3><p>相信大家对redis-cli已经很熟悉了，作为Redis自带的命令行客户端，你可以从任何安装有Redis的服务器中找到它，所以对于管理Redis而言redis-cli是最简单实用的工具。<br>redis-cli可以执行大部分的Redis命令，包括查看数据库信息的<code>INFO</code>命令，更改数据库设置的<code>CONFIG</code>命令和强制进行RDB快照的<code>SAVE</code>命令等，下面会介绍几个管理Redis时非常有用的命令。<br><strong>1．耗时命令日志</strong><br>当一条命令执行时间超过限制时，Redis会将该命令的执行时间等信息加入耗时命令日志（slow log）以供开发者查看。可以通过配置文件的<code>slowlog-log-slower-than</code>参数设置这一限制，要注意单位是微秒（1000000微秒相当于1秒），默认值是10000。耗时命令日志存储在内存中，可以通过配置文件的<code>slowlog-max-len</code>参数来限制记录的条数。<br>使用<code>SLOWLOG GET</code>命令来获得当前的耗时命令日志，如：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis&gt;SLOWLOG GET</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="number">1</span>) (<span class="type">integer</span>) <span class="number">4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>) (<span class="type">integer</span>) <span class="number">1356806413</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>) (<span class="type">integer</span>) <span class="number">58</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>) <span class="number">1</span>) <span class="string">"get"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>) <span class="string">"foo"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>) <span class="number">1</span>) (<span class="type">integer</span>) <span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>) (<span class="type">integer</span>) <span class="number">1356806408</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>) (<span class="type">integer</span>) <span class="number">34</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>) <span class="number">1</span>) <span class="string">"set"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>) <span class="string">"foo"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>) <span class="string">"bar"</span></span></pre></td></tr></table></figure>

<p>每条日志都由以下4个部分组成：<br>（1）该日志唯一ID；<br>（2）该命令执行的UNIX时间；<br>（3）该命令的耗时时间，单位是微秒；<br>（4）命令及其参数。<br><strong>提示</strong> 为了产生一些耗时命令日志作为演示，这里将slowlog-log-slower-than参数值设置为O，即记录所有命令。如果设置为负数则会关闭耗时命令日志。<br><strong>2．命令监控</strong><br>Redis提供了<code>MONITOR</code>命令来监控Redis执行的所有命令，redis-cli同样支持这个命令，如在redis-cli中执行MONITOR：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis&gt; <span class="literal">MONITOR</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">OK</span></pre></td></tr></table></figure>

<p>这时Redis执行的任何命令都会在redis-cli中打印出来，如我们打开另一个redis-cli执行SET foo bar命令，在之前的redis-cli中会输出如下内容：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="number">1356806981.885237</span> [<span class="number">0</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">57339</span>] <span class="string">"SET"</span> <span class="string">"foo"</span> <span class="string">"bar</span></span></pre></td></tr></table></figure>

<p>MONITOR命令非常影响Redis的性能，一个客户端使用MONITOR命令会降低 Redis将近一半的负载能力。所以MONITOR命令只适合用来调试和纠错。<br><strong>补充知识</strong> Instagram① 团队开发了一个基于MONITOR命令的Redis查询分析程序redis-faina。redis-faina可以根据MONITOR命令的监控结果分析出最常用的命令、访问最频繁的键等信息，对了解Redis的使用情况帮助很大。<br>redis-faina的项目地址是<a href="https://github.com/Instagram/redis-faina，直接下载其中的redis-faina.py文件即可使用。" target="_blank" rel="noopener">https://github.com/Instagram/redis-faina，直接下载其中的redis-faina.py文件即可使用。</a><br>redis-faina.py的输入值为一段时间的MONITOR命令执行结果。例如：</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis-cli MONITOR | <span class="type">head</span> -n ＜要分析的命令数＞ | <span class="type">./redis</span>-faina.py</span></pre></td></tr></table></figure>

<h3 id="7-5-2-phpRedisAdmin"><a href="#7-5-2-phpRedisAdmin" class="headerlink" title="7.5.2 phpRedisAdmin"></a><strong>7.5.2 phpRedisAdmin</strong></h3><p>当Redis中的键较多时，使用redis-cli管理数据并不是很方便，就如同管理MySQL时有人喜欢使用phpMyAdmin一样，Redis同样有一个PHP开发的网页端管理工具phpRedisAdmin。phpRedisAdmin支持以树形结构查看键列表，编辑键值，导入/导出数据库数据，查看数据库信息和查看键信息等功能。<br><strong>1．安装phpRedisAdmin安装phpRedisAdmin的方法如下：</strong></p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/ErikDubbelboer/phpRedisAdmin.git</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">cd phpRedisAdmin</span></pre></td></tr></table></figure>

<p>phpRedisAdmin依赖PHP的Redis客户端Predis，所以还需要执行下面两个命令下载Predis：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">submodule </span>init</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">submodule </span>update</span></pre></td></tr></table></figure>

<p><strong>2．配置数据库连接</strong><br>下载完phpRedisAdmin后需要配置Redis的连接信息。默认phpRedisAdmin会连接到127.0.0.1，端口6379，如果需要更改或者添加数据库信息可以编辑includes文件夹中的config.inc. php文件。<br><strong>3．使用phpRedisAdmin</strong><br>安装PHP和Web服务器（如Nginx），并将phpRedisAdmin文件夹存放到网站目录中即可访问，如图7-3所示。<br>phpRedisAdmin自动将Redis的键以“:”分隔并用树形结构显示出来，十分直观。如post:1和post:2两个键都在post树中。<br>点击一个键后可以查看键的信息，包括键的类型、生存时间及键值，并且可以很方便地编辑。<br><strong>4．性能</strong><br>phpRedisAdmin在获取键列表时使用的是KEYS＊命令，然后对所有的键使用TYPE命令来获取其数据类型，所以当键非常多的时候性能并不高（对于一个有一百万个键的Redis数据库，在一台普通个人计算机上使用KEYS＊命令大约会花费几十毫秒）。由于Redis使用单线程处理命令，所以对生产环境下拥有大数据量的数据库来说不适宜使用phpRedisAdmin管理。</p>
<h3 id="7-5-3-Rdbtools"><a href="#7-5-3-Rdbtools" class="headerlink" title="7.5.3 Rdbtools"></a><strong>7.5.3 Rdbtools</strong></h3><p>Rdbtools是一个Redis的快照文件解析器，它可以根据快照文件导出JSON数据文件、分析Redis中每个键的占用空间情况等。Rdbtools是使用Python开发的，项目地址是<a href="https://github.com/sripathikrishnan/redis-rdb-tools。" target="_blank" rel="noopener">https://github.com/sripathikrishnan/redis-rdb-tools。</a><br><strong>1．安装Rdbtools</strong><br>使用如下命令安装Rdbtools：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/sripathikrishnan/redis-rdb-tools</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> redis-rdb-tools</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> install</span></pre></td></tr></table></figure>

<p><strong>2．生成快照文件</strong><br>如果没有启用RDB持久化，可以使用SAVE命令手动使Redis生成快照文件。<br><strong>3．将快照导出为JSON格式</strong><br>快照文件是二进制格式，不利于查看，可以使用Rdbtools来将其导出为JSON格式，命令如下：</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">rdb <span class="params">--command</span> json <span class="string">/path/to/dump.rdb</span> ＞ output_filename.json</span></pre></td></tr></table></figure>

<p>其中/path/to/dump.rdb是快照文件的路径，output_filename.json为要导出的文件路径。<br>4．生成空间使用情况报告<br>Rdbtools能够将快照文件中记录的每个键的存储情况导出为CSV文件，可以将该CSV文件导入到Excel等数据分析工具中分析来了解Redis的使用情况。命令如下：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">rdb -<span class="keyword">c</span> memory /path/<span class="keyword">to</span>/dump.rdb ＞ output_filename.csv</span></pre></td></tr></table></figure>

<p>导出的CSV文件的字段及说明如表7-1所示。<br><img src="http://image.winrains.cn/2019/10/665aa-1458312651066088899.png" alt="QQ截图20160318225010.png"></p>
<h2 id="7-6-Redis-性能测试"><a href="#7-6-Redis-性能测试" class="headerlink" title="7.6 Redis 性能测试"></a>7.6 Redis 性能测试</h2><p><strong>语法</strong><br>redis 性能测试的基本命令如下：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">redis-benchmark [<span class="keyword">option</span>] [<span class="keyword">option</span> <span class="keyword">value</span>]</span></pre></td></tr></table></figure>

<p><strong>实例</strong><br>以下实例同时执行 10000 个请求来检测性能：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">redis-benchmark</span> <span class="string">-n</span> <span class="number">10000</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="attr">PING_INLINE:</span> <span class="number">141043.72</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="attr">PING_BULK:</span> <span class="number">142857.14</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="attr">SET:</span> <span class="number">141442.72</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="attr">GET:</span> <span class="number">145348.83</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="attr">INCR:</span> <span class="number">137362.64</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="attr">LPUSH:</span> <span class="number">145348.83</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="attr">LPOP:</span> <span class="number">146198.83</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="attr">SADD:</span> <span class="number">146198.83</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="attr">SPOP:</span> <span class="number">149253.73</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">LPUSH</span> <span class="string">(needed</span> <span class="string">to</span> <span class="string">benchmark</span> <span class="string">LRANGE):</span> <span class="number">148588.42</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="string">LRANGE_100</span> <span class="string">(first</span> <span class="number">100</span> <span class="string">elements):</span> <span class="number">58411.21</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="string">LRANGE_300</span> <span class="string">(first</span> <span class="number">300</span> <span class="string">elements):</span> <span class="number">21195.42</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="string">LRANGE_500</span> <span class="string">(first</span> <span class="number">450</span> <span class="string">elements):</span> <span class="number">14539.11</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="string">LRANGE_600</span> <span class="string">(first</span> <span class="number">600</span> <span class="string">elements):</span> <span class="number">10504.20</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="string">MSET</span> <span class="string">(10</span> <span class="string">keys):</span> <span class="number">93283.58</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr></table></figure>

<p>redis 性能测试工具可选参数如下所示：</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>选项</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><strong>-h</strong></td>
<td>指定服务器主机名</td>
<td>127.0.0.1</td>
</tr>
<tr>
<td>2</td>
<td><strong>-p</strong></td>
<td>指定服务器端口</td>
<td>6379</td>
</tr>
<tr>
<td>3</td>
<td><strong>-s</strong></td>
<td>指定服务器 socket</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td><strong>-c</strong></td>
<td>指定并发连接数</td>
<td>50</td>
</tr>
<tr>
<td>5</td>
<td><strong>-n</strong></td>
<td>指定请求数</td>
<td>10000</td>
</tr>
<tr>
<td>6</td>
<td><strong>-d</strong></td>
<td>以字节的形式指定 SET/GET 值的数据大小</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td><strong>-k</strong></td>
<td>1=keep alive 0=reconnect</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td><strong>-r</strong></td>
<td>SET/GET/INCR 使用随机 key, SADD 使用随机值</td>
<td></td>
</tr>
<tr>
<td>9</td>
<td><strong>-P</strong></td>
<td>通过管道传输 <numreq> 请求</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td><strong>-q</strong></td>
<td>强制退出 redis。仅显示 query/sec 值</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td><strong>–csv</strong></td>
<td>以 CSV 格式输出</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td><strong>-l</strong></td>
<td>生成循环，永久执行测试</td>
<td></td>
</tr>
<tr>
<td>13</td>
<td><strong>-t</strong></td>
<td>仅运行以逗号分隔的测试命令列表。</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td><strong>-I</strong></td>
<td>Idle 模式。仅打开 N 个 idle 连接并等待。</td>
<td></td>
</tr>
</tbody></table>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>以下实例我们使用了多个参数来测试 redis 性能：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">redis-benchmark</span> <span class="string">-h</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="string">-p</span> <span class="number">6379</span> <span class="string">-t</span> <span class="string">set,lpush</span> <span class="string">-n</span> <span class="number">10000</span> <span class="string">-q</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"> </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="attr">SET:</span> <span class="number">146198.83</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="attr">LPUSH:</span> <span class="number">145560.41</span> <span class="string">requests</span> <span class="string">per</span> <span class="string">second</span></span></pre></td></tr></table></figure>

<p>以上实例中主机为 127.0.0.1，端口号为 6379，执行的命令为 set,lpush，请求数为 10000，通过 -q 参数让结果只显示每秒执行的请求数。<br>参考文档：<br><a href="http://ifeve.com/redis-benchmarks/" target="_blank" rel="noopener">http://ifeve.com/redis-benchmarks/</a><br><a href="http://www.runoob.com/redis/redis-benchmarks.html" target="_blank" rel="noopener">http://www.runoob.com/redis/redis-benchmarks.html</a></p>
<h2 id="7-8-Redis-客户端连接"><a href="#7-8-Redis-客户端连接" class="headerlink" title="7.8 Redis 客户端连接"></a>7.8 Redis 客户端连接</h2><p>Redis 通过监听一个 TCP 端口或者 Unix socket 的方式来接收来自客户端的连接，当一个连接建立后，Redis 内部会进行以下一些操作：</p>
<ul>
<li>首先，客户端 socket 会被设置为非阻塞模式，因为 Redis 在网络事件处理上采用的是非阻塞多路复用模型。</li>
<li>然后为这个 socket 设置 TCP_NODELAY 属性，禁用 Nagle 算法</li>
<li>然后创建一个可读的文件事件用于监听这个客户端 socket 的数据发送</li>
</ul>
<p><strong>最大连接数</strong><br>在 Redis2.4 中，最大连接数是被直接硬编码在代码里面的，而在2.6版本中这个值变成可配置的。<br><code>maxclients</code>的默认值是 <code>10000</code>，你也可以在 redis.conf 中对这个值进行修改。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">config</span> <span class="built_in">get</span> maxclients</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)<span class="string">"maxclients"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>)<span class="string">"10000"</span></span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>S.N.</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><strong>CLIENT LIST</strong></td>
<td>返回连接到 redis 服务的客户端列表</td>
</tr>
<tr>
<td>2</td>
<td><strong>CLIENT SETNAME</strong></td>
<td>设置当前连接的名称</td>
</tr>
<tr>
<td>3</td>
<td><strong>CLIENT GETNAME</strong></td>
<td>获取通过 CLIENT SETNAME 命令设置的服务名称</td>
</tr>
<tr>
<td>4</td>
<td><strong>CLIENT PAUSE</strong></td>
<td>挂起客户端连接，指定挂起的时间以毫秒计</td>
</tr>
<tr>
<td>5</td>
<td><strong>CLIENT KILL</strong></td>
<td>关闭客户端连接</td>
</tr>
</tbody></table>
<h2 id="7-9-Redis-服务器"><a href="#7-9-Redis-服务器" class="headerlink" title="7.9 Redis 服务器"></a>7.9 Redis 服务器</h2><p>以下实例演示了如何获取 redis 服务器的统计信息：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="section">127.0.0.1:6379&gt; INFO</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Server</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="section">redis_version:3.0.7</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="section">redis_git_sha1:00000000</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="section">redis_git_dirty:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="section">redis_build_id:d8d764d8bdb260a1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="section">redis_mode:standalone</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="section">os:Linux 3.10.0-123.9.3.el7.x86_64 x86_64</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="section">arch_bits:64</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="section">multiplexing_api:epoll</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="section">gcc_version:4.8.2</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="section">process_id:24865</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="section">run_id:6cb5ecae3a2035fbf4a0c8b539c5f2d28282b9eb</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="section">tcp_port:6379</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="section">uptime_in_seconds:128229</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="section">uptime_in_days:1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="section">hz:10</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="section">lru_clock:15483518</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="section">config_file:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Clients</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="section">connected_clients:1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="section">client_longest_output_list:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="section">client_biggest_input_buf:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="section">blocked_clients:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Memory</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory:816072</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory_human:796.95K</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory_rss:2527232</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory_peak:836920</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory_peak_human:817.30K</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_memory_lua:36864</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="section">mem_fragmentation_ratio:3.10</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="section">mem_allocator:jemalloc-3.6.0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Persistence</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="section">loading:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_changes_since_last_save:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_bgsave_in_progress:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_last_save_time:1458285243</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_last_bgsave_status:ok</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_last_bgsave_time_sec:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="section">rdb_current_bgsave_time_sec:-1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_enabled:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_rewrite_in_progress:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_rewrite_scheduled:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_last_rewrite_time_sec:-1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_current_rewrite_time_sec:-1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_last_bgrewrite_status:ok</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"><span class="section">aof_last_write_status:ok</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Stats</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="section">total_connections_received:5</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="section">total_commands_processed:81</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"><span class="section">instantaneous_ops_per_sec:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"><span class="section">total_net_input_bytes:2549</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"><span class="section">total_net_output_bytes:5289</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"><span class="section">instantaneous_input_kbps:0.00</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"><span class="section">instantaneous_output_kbps:0.00</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line"><span class="section">rejected_connections:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line"><span class="section">sync_full:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line"><span class="section">sync_partial_ok:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"><span class="section">sync_partial_err:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"><span class="section">expired_keys:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"><span class="section">evicted_keys:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"><span class="section">keyspace_hits:36</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"><span class="section">keyspace_misses:4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line"><span class="section">pubsub_channels:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"><span class="section">pubsub_patterns:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"><span class="section">latest_fork_usec:182</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line"><span class="section">migrate_cached_sockets:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Replication</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"><span class="section">role:master</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line"><span class="section">connected_slaves:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"><span class="section">master_repl_offset:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line"><span class="section">repl_backlog_active:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"><span class="section">repl_backlog_size:1048576</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"><span class="section">repl_backlog_first_byte_offset:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line"><span class="section">repl_backlog_histlen:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># CPU</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_cpu_sys:75.82</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_cpu_user:53.30</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_cpu_sys_children:0.00</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line"><span class="section">used_cpu_user_children:0.00</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Cluster</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"><span class="section">cluster_enabled:0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keyspace</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line"><span class="section">db0:keys=7,expires=0,avg_ttl=0</span></span></pre></td></tr></table></figure>

<p>下表列出了 redis 服务器的相关命令:</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令及描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><a href="http://www.runoob.com/redis/server-bgrewriteaof.html" target="_blank" rel="noopener">BGREWRITEAOF</a> 异步执行一个 AOF（AppendOnly File） 文件重写操作</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://www.runoob.com/redis/server-bgsave.html" target="_blank" rel="noopener">BGSAVE</a> 在后台异步保存当前数据库的数据到磁盘</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://www.runoob.com/redis/server-client-kill.html" target="_blank" rel="noopener">CLIENT KILL [ip:port] [ID client-id]</a> 关闭客户端连接</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://www.runoob.com/redis/server-client-list.html" target="_blank" rel="noopener">CLIENT LIST</a> 获取连接到服务器的客户端连接列表</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://www.runoob.com/redis/server-client-getname.html" target="_blank" rel="noopener">CLIENT GETNAME</a> 获取连接的名称</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://www.runoob.com/redis/server-client-pause.html" target="_blank" rel="noopener">CLIENT PAUSE timeout</a> 在指定时间内终止运行来自客户端的命令</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://www.runoob.com/redis/server-client-setname.html" target="_blank" rel="noopener">CLIENT SETNAME connection-name</a> 设置当前连接的名称</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://www.runoob.com/redis/server-cluster-slots.html" target="_blank" rel="noopener">CLUSTER SLOTS</a> 获取集群节点的映射数组</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://www.runoob.com/redis/server-command.html" target="_blank" rel="noopener">COMMAND</a> 获取 Redis 命令详情数组</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://www.runoob.com/redis/server-command-count.html" target="_blank" rel="noopener">COMMAND COUNT</a> 获取 Redis 命令总数</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://www.runoob.com/redis/server-command-getkeys.html" target="_blank" rel="noopener">COMMAND GETKEYS</a> 获取给定命令的所有键</td>
</tr>
<tr>
<td>12</td>
<td><a href="http://www.runoob.com/redis/server-time.html" target="_blank" rel="noopener">TIME</a> 返回当前服务器时间</td>
</tr>
<tr>
<td>13</td>
<td><a href="http://www.runoob.com/redis/server-command-info.html" target="_blank" rel="noopener">COMMAND INFO command-name [command-name …]</a> 获取指定 Redis 命令描述的数组</td>
</tr>
<tr>
<td>14</td>
<td><a href="http://www.runoob.com/redis/server-config-get.html" target="_blank" rel="noopener">CONFIG GET parameter</a> 获取指定配置参数的值</td>
</tr>
<tr>
<td>15</td>
<td><a href="http://www.runoob.com/redis/server-config-rewrite.html" target="_blank" rel="noopener">CONFIG REWRITE</a> 对启动 Redis 服务器时所指定的 redis.conf 配置文件进行改写</td>
</tr>
<tr>
<td>16</td>
<td><a href="http://www.runoob.com/redis/server-config-set.html" target="_blank" rel="noopener">CONFIG SET parameter value</a> 修改 redis 配置参数，无需重启</td>
</tr>
<tr>
<td>17</td>
<td><a href="http://www.runoob.com/redis/server-config-resetstat.html" target="_blank" rel="noopener">CONFIG RESETSTAT</a> 重置 INFO 命令中的某些统计数据</td>
</tr>
<tr>
<td>18</td>
<td><a href="http://www.runoob.com/redis/server-dbsize.html" target="_blank" rel="noopener">DBSIZE</a> 返回当前数据库的 key 的数量</td>
</tr>
<tr>
<td>19</td>
<td><a href="http://www.runoob.com/redis/server-debug-object.html" target="_blank" rel="noopener">DEBUG OBJECT key</a> 获取 key 的调试信息</td>
</tr>
<tr>
<td>20</td>
<td><a href="http://www.runoob.com/redis/server-debug-segfault.html" target="_blank" rel="noopener">DEBUG SEGFAULT</a> 让 Redis 服务崩溃</td>
</tr>
<tr>
<td>21</td>
<td><a href="http://www.runoob.com/redis/server-flushall.html" target="_blank" rel="noopener">FLUSHALL</a> 删除所有数据库的所有key</td>
</tr>
<tr>
<td>22</td>
<td><a href="http://www.runoob.com/redis/server-flushdb.html" target="_blank" rel="noopener">FLUSHDB</a> 删除当前数据库的所有key</td>
</tr>
<tr>
<td>23</td>
<td><a href="http://www.runoob.com/redis/server-info.html" target="_blank" rel="noopener">INFO [section]</a> 获取 Redis 服务器的各种信息和统计数值</td>
</tr>
<tr>
<td>24</td>
<td><a href="http://www.runoob.com/redis/server-lastsave.html" target="_blank" rel="noopener">LASTSAVE</a> 返回最近一次 Redis 成功将数据保存到磁盘上的时间，以 UNIX 时间戳格式表示</td>
</tr>
<tr>
<td>25</td>
<td><a href="http://www.runoob.com/redis/server-monitor.html" target="_blank" rel="noopener">MONITOR</a> 实时打印出 Redis 服务器接收到的命令，调试用</td>
</tr>
<tr>
<td>26</td>
<td><a href="http://www.runoob.com/redis/server-role.html" target="_blank" rel="noopener">ROLE</a> 返回主从实例所属的角色</td>
</tr>
<tr>
<td>27</td>
<td><a href="http://www.runoob.com/redis/server-save.html" target="_blank" rel="noopener">SAVE</a> 异步保存数据到硬盘</td>
</tr>
<tr>
<td>28</td>
<td><a href="http://www.runoob.com/redis/server-shutdown.html" target="_blank" rel="noopener">SHUTDOWN [NOSAVE] [SAVE]</a> 异步保存数据到硬盘，并关闭服务器</td>
</tr>
<tr>
<td>29</td>
<td><a href="http://www.runoob.com/redis/server-slaveof.html" target="_blank" rel="noopener">SLAVEOF host port</a> 将当前服务器转变为指定服务器的从属服务器(slave server)</td>
</tr>
<tr>
<td>30</td>
<td><a href="http://www.runoob.com/redis/server-showlog.html" target="_blank" rel="noopener">SLOWLOG subcommand [argument]</a> 管理 redis 的慢日志</td>
</tr>
<tr>
<td>31</td>
<td><a href="http://www.runoob.com/redis/server-sync.html" target="_blank" rel="noopener">SYNC</a> 用于复制功能(replication)的内部命令</td>
</tr>
</tbody></table>
<blockquote>
<p>作者：田守芝</p>
<p>来源：<a href="http://www.tianshouzhi.com/api/tutorials/redis/193" target="_blank" rel="noopener">http://www.tianshouzhi.com/api/tutorials/redis/193</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/12/29/Redis%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%885%EF%BC%89%EF%BC%9A%E9%AB%98%E5%8F%AF%E7%94%A8/" rel="prev" title="Redis使用教程（5）：高可用">
      <i class="fa fa-chevron-left"></i> Redis使用教程（5）：高可用
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/12/29/Spring-Boot%E7%9F%A5%E8%AF%86%E6%B8%85%E5%8D%95/" rel="next" title="Spring Boot知识清单">
      Spring Boot知识清单 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#7-管理"><span class="nav-number">1.</span> <span class="nav-text">7 管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-安全"><span class="nav-number">1.1.</span> <span class="nav-text">7.3 安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-1-可信的环境"><span class="nav-number">1.1.1.</span> <span class="nav-text">7.3.1 可信的环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-2-数据库密码"><span class="nav-number">1.1.2.</span> <span class="nav-text">7.3.2 数据库密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-3-命名命令"><span class="nav-number">1.1.3.</span> <span class="nav-text">7.3.3 命名命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-通信协议"><span class="nav-number">1.2.</span> <span class="nav-text">7.4 通信协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-4-1-简单协议"><span class="nav-number">1.2.1.</span> <span class="nav-text">7.4.1 简单协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-4-2-统一请求协议"><span class="nav-number">1.2.2.</span> <span class="nav-text">7.4.2 统一请求协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-管理工具"><span class="nav-number">1.3.</span> <span class="nav-text">7.5 管理工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5-1-redis-cli"><span class="nav-number">1.3.1.</span> <span class="nav-text">7.5.1 redis-cli</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5-2-phpRedisAdmin"><span class="nav-number">1.3.2.</span> <span class="nav-text">7.5.2 phpRedisAdmin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5-3-Rdbtools"><span class="nav-number">1.3.3.</span> <span class="nav-text">7.5.3 Rdbtools</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-Redis-性能测试"><span class="nav-number">1.4.</span> <span class="nav-text">7.6 Redis 性能测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#实例"><span class="nav-number">1.4.1.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-8-Redis-客户端连接"><span class="nav-number">1.5.</span> <span class="nav-text">7.8 Redis 客户端连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-9-Redis-服务器"><span class="nav-number">1.6.</span> <span class="nav-text">7.9 Redis 服务器</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">congsheng.wang</p>
  <div class="site-description" itemprop="description">trouble is a friend</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">984</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">94</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">156</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">congsheng.wang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
