<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://congsheng.wang').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="在本教程的第 1 部分中，我介绍了 JUnit 5 的设置说明，以及 JUnit 5 的架构和组件。还介绍了如何使用 JUnit Jupiter API 中的新特性，包括注解、断言和前置条件。在本部分中，您将熟悉组成全新 JUnit 5 的另外两个模块：JUnit Vintage 和 JUnit Jupiter 扩展模型。我将介绍如何使用这些组件实现参数注入、参数化测试、动态测试和自定义注解等。与">
<meta name="keywords" content="JUnit">
<meta property="og:type" content="article">
<meta property="og:title" content="JUnit 5 简介：Vintage 和 JUnit Jupiter 扩展模型">
<meta property="og:url" content="http:&#x2F;&#x2F;congsheng.wang&#x2F;2019&#x2F;12&#x2F;26&#x2F;JUnit-5-%E7%AE%80%E4%BB%8B%EF%BC%9AVintage-%E5%92%8C-JUnit-Jupiter-%E6%89%A9%E5%B1%95%E6%A8%A1%E5%9E%8B&#x2F;index.html">
<meta property="og:site_name" content="个人博客">
<meta property="og:description" content="在本教程的第 1 部分中，我介绍了 JUnit 5 的设置说明，以及 JUnit 5 的架构和组件。还介绍了如何使用 JUnit Jupiter API 中的新特性，包括注解、断言和前置条件。在本部分中，您将熟悉组成全新 JUnit 5 的另外两个模块：JUnit Vintage 和 JUnit Jupiter 扩展模型。我将介绍如何使用这些组件实现参数注入、参数化测试、动态测试和自定义注解等。与">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;08&#x2F;c0740-Figure-1.png">
<meta property="og:updated_time" content="2019-12-26T11:18:38.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;image.winrains.cn&#x2F;2019&#x2F;08&#x2F;c0740-Figure-1.png">

<link rel="canonical" href="http://congsheng.wang/2019/12/26/JUnit-5-%E7%AE%80%E4%BB%8B%EF%BC%9AVintage-%E5%92%8C-JUnit-Jupiter-%E6%89%A9%E5%B1%95%E6%A8%A1%E5%9E%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>JUnit 5 简介：Vintage 和 JUnit Jupiter 扩展模型 | 个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">congsheng的博客</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">156</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">94</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">984</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://congsheng.wang/2019/12/26/JUnit-5-%E7%AE%80%E4%BB%8B%EF%BC%9AVintage-%E5%92%8C-JUnit-Jupiter-%E6%89%A9%E5%B1%95%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="congsheng.wang">
      <meta itemprop="description" content="trouble is a friend">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JUnit 5 简介：Vintage 和 JUnit Jupiter 扩展模型
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-12-26 19:18:38" itemprop="dateCreated datePublished" datetime="2019-12-26T19:18:38+08:00">2019-12-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">Java技术</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>在本教程的<a href="https://www.ibm.com/developerworks/cn/java/j-introducing-junit5-part1-jupiter-api/index.html" target="_blank" rel="noopener">第 1 部分</a>中，我介绍了 JUnit 5 的设置说明，以及 JUnit 5 的架构和组件。还介绍了如何使用 JUnit Jupiter API 中的新特性，包括注解、断言和前置条件。<br>在本部分中，您将熟悉组成全新 JUnit 5 的另外两个模块：JUnit Vintage 和 JUnit Jupiter 扩展模型。我将介绍如何使用这些组件实现参数注入、参数化测试、动态测试和自定义注解等。<br>与第 1 部分中一样，我将介绍如何使用 Maven 和 Gradle 运行测试。<br>请注意，本教程的示例基于 <a href="http://junit.org/junit5/docs/current/user-guide/#release-notes-5.0.2" target="_blank" rel="noopener">JUnit 5,Version 5.0.2</a>。</p>
<a id="more"></a>

<h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>假设您熟悉以下软件的使用：</p>
<ul>
<li>Eclipse IDE</li>
<li>Maven</li>
<li>Gradle（可选）</li>
<li>Git</li>
</ul>
<p>要跟随示例进行操作，您应在计算机上安装 JDK 8、Eclipse、Maven、Gradle（可选）和 Git。如果缺少其中的任何工具，可使用下面的链接下载和安装它们：</p>
<ul>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">JDK 8 for Windows, Mac, and Linux。</a></li>
<li><a href="http://www.eclipse.org/downloads/eclipse-packages/" target="_blank" rel="noopener">Eclipse IDE for Windows, Mac, and Linux。</a></li>
<li><a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">Apache Maven for Windows, Mac, and Linux。</a></li>
<li><a href="https://gradle.org/install" target="_blank" rel="noopener">Gradle for Windows, Mac, and Linux。</a></li>
<li><a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git for Windows, Mac, and Linux。</a></li>
</ul>
<p><a href="https://github.com/makotogo/HelloJUnit5Part2" target="_blank" rel="noopener">从 GitHub 克隆示例应用程序</a></p>
<h2 id="JUnit-Vintage"><a href="#JUnit-Vintage" class="headerlink" title="JUnit Vintage"></a>JUnit Vintage</h2><p>升级到新的重要软件版本始终存在风险，但是在这里，升级不仅是个好主意，而且还很安全。<br>因为许多组织对 JUnit 4 （甚至对 JUnit 3）进行了大力投资，所以 JUnit 5 的开发团队创建了 JUnit Vintage 包，其中包含 JUnit Vintage 测试引擎。JUnit Vintage 可确保现有 JUnit 测试能与使用 JUnit Jupiter 创建的新测试一同运行。<br>JUnit 5 的架构还支持同时运行多个测试引擎：可以一同运行 JUnit Vintage 测试引擎和任何其他兼容 JUnit 5 的测试引擎。<br>现在您已了解 JUnit Vintage，可能想知道它的工作原理。图 1 给出了来自第 1 部分的 JUnit 5 依赖关系图，展示了 JUnit 5 中各种包之间的关系。</p>
<p>图 1. JUnit 5 依赖关系图</p>
<p><img src="http://image.winrains.cn/2019/08/c0740-Figure-1.png" alt="JUnit 5 依赖关系示意图。"><br>图 1 中间行中所示的 JUnit Vintage 旨在提供一条通往 JUnit Jupiter 的 “平稳升级路径”。两个 JUnit 5 模块依赖于 JUnit Vintage：</p>
<ul>
<li><strong>junit-platform-runner</strong> 提供一个 <code>Runner</code>，允许在 JUnit 4 环境（比如 Eclipse）中执行测试。</li>
<li><strong>junit-jupiter-migration-support</strong> 提供了后向兼容性，允许您选择 JUnit 4 <code>Rule</code>。</li>
</ul>
<p>JUnit Vintage 本身由两个模块组成：</p>
<ul>
<li><strong>junit:junit</strong> 是用于 JUnit 3 和 JUnit 4 的 API。</li>
<li><strong>junit-vintage-engine</strong> 是在 JUnit Platform 上运行 JUnit 3 和 JUnit 4 测试的测试引擎。</li>
</ul>
<p>因为 JUnit Platform 允许多个测试引擎同时运行，所以可让您的 JUnit 3 和 JUnit 4 测试与使用 JUnit Jupiter 编写的测试并列运行。教程后面将介绍如何执行该操作。<br>在 Eclipse、Maven 和 Gradle 中运行测试之前，我们花点时间复习一下基本单元测试的概念。我们将分析在 JUnit 3 和 JUnit 4 中编写的测试。</p>
<h3 id="JUnit-3-中的测试"><a href="#JUnit-3-中的测试" class="headerlink" title="JUnit 3 中的测试"></a>JUnit 3 中的测试</h3><p>使用 JUnit 3 编写的测试将按原样在 JUnit Platform 上运行。只需将 <code>junit-vintage</code> 依赖项包含在构建版本中，其他部分就能直接运行。<br>在示例应用程序中，您将看到已包含在示例应用程序中的 Maven POM (<code>pom.xml</code>) 和 Gradle 构建文件 (<code>build.gradle</code>)，所以您可立即运行这些测试。<br>清单 1 给出了示例应用程序的一个 JUnit 3 测试的<em>部分</em>内容。它位于 <code>com.makotojava.learn.junit3</code> 包中的 <code>src/test/java</code> 树中。</p>
<p>清单 1. HelloJunit5Part2 示例应用程序的 JUnit 3 测试用例</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public <span class="keyword">class</span> PersonDaoBeanTest extends TestCase &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> ApplicationContext ctx;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> PersonDaoBean classUnderTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    @Override</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    protected void set<span class="constructor">Up()</span> throws Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        ctx = <span class="keyword">new</span> <span class="constructor">AnnotationConfigApplicationContext(TestSpringConfiguration.<span class="params">class</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        classUnderTest = ctx.get<span class="constructor">Bean(PersonDaoBean.<span class="params">class</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    @Override</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    protected void tear<span class="constructor">Down()</span> throws Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        DataSource dataSource = (DataSource) ctx.get<span class="constructor">Bean(<span class="string">"dataSource"</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (dataSource instanceof EmbeddedDatabase) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">            ((EmbeddedDatabase) dataSource).shutdown<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    public void test<span class="constructor">FindAll()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        List&lt;Person&gt; people = classUnderTest.find<span class="constructor">All()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">people</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">False(<span class="params">people</span>.<span class="params">isEmpty</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">Equals(5, <span class="params">people</span>.<span class="params">size</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>JUnit 3 测试用例扩展了 JUnit 3 API 类 <code>TestCase</code>（第 3 行），每个测试方法必须以单词 <code>test</code> 开头（第 23 行）。<br>要在 Eclipse 中运行此测试，可右键单击 Package Explorer 视图中的测试类，选择 <strong>Run As &gt; Junit Test</strong>。<br>教程后面将介绍如何使用 Maven 和 Gradle 运行此测试。</p>
<h3 id="JUnit-4-中的测试"><a href="#JUnit-4-中的测试" class="headerlink" title="JUnit 4 中的测试"></a>JUnit 4 中的测试</h3><p>您的 JUnit 4 测试按原样在 JUnit Platform 上运行。只需将 <code>junit-vintage</code> 依赖项包含在构建版本中，就能直接运行它。<br>示例应用程序中包含的 Maven POM 和 Gradle 构建文件 (<code>build.gradle</code>) 中已包含该依赖项，所以您可立即运行这些测试。<br>清单 2 给出了示例应用程序的一个 JUnit 4 测试的<em>部分</em>内容。它位于 <code>com.makotojava.learn.junit4</code> 包中的 <code>src/test/java</code> 树中。</p>
<p>清单 2. HelloJunit5Part2 示例应用程序的 JUnit 4 测试用例</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public <span class="keyword">class</span> PersonDaoBeanTest &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> ApplicationContext ctx;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> PersonDaoBean classUnderTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    @Before</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    public void set<span class="constructor">Up()</span> throws Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        ctx = <span class="keyword">new</span> <span class="constructor">AnnotationConfigApplicationContext(TestSpringConfiguration.<span class="params">class</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        classUnderTest = ctx.get<span class="constructor">Bean(PersonDaoBean.<span class="params">class</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    @After</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    public void tear<span class="constructor">Down()</span> throws Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        DataSource dataSource = (DataSource) ctx.get<span class="constructor">Bean(<span class="string">"dataSource"</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (dataSource instanceof EmbeddedDatabase) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">            ((EmbeddedDatabase) dataSource).shutdown<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    @Test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    public void find<span class="constructor">All()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        List&lt;Person&gt; people = classUnderTest.find<span class="constructor">All()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">people</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">False(<span class="params">people</span>.<span class="params">isEmpty</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">Equals(5, <span class="params">people</span>.<span class="params">size</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>JUnit 4 测试用例以单词 <code>Test</code> 结尾（第 3 行），每个测试方法使用 <code>@Test</code> 注解（第 23 行）。<br>要在 Eclipse 中运行此测试，可右键单击 Package Explorer 视图中的测试类，选择 <strong>Run As &gt; Junit Test</strong>。<br>教程后面将介绍如何使用 Maven 和 Gradle 运行此测试。</p>
<h3 id="对迁移到-JUnit-Jupiter-的支持"><a href="#对迁移到-JUnit-Jupiter-的支持" class="headerlink" title="对迁移到 JUnit Jupiter 的支持"></a>对迁移到 JUnit Jupiter 的支持</h3><p>从 JUnit 4 迁移<br>打算从 JUnit4 迁移？一定要通读<a href="http://junit.org/junit5/docs/current/user-guide/#migrating-from-junit4" target="_blank" rel="noopener">文档</a>。</p>
<p><code>junit-jupiter-migration-support</code> 包中包含了用于后向兼容性的一些选定 <code>Rule</code>，所以如果您对 JUnit 4 规则进行了大力投资也不用担心。在 JUnit 5 中，您将使用 JUnit Jupiter 扩展模型实现 JUnit 4 中的各种规则提供的相同行为。下一节将介绍如何完成该工作。</p>
<h2 id="JUnit-Jupiter-扩展模型"><a href="#JUnit-Jupiter-扩展模型" class="headerlink" title="JUnit Jupiter 扩展模型"></a>JUnit Jupiter 扩展模型</h2><p>通过使用 JUnit 扩展模型，现在任何开发人员或工具供应商都能扩展 JUnit 的核心功能。<br>要想真正认识到 JUnit Jupiter 扩展模型的开创性，需要理解它<em>如何</em>扩展 JUnit 4 的核心功能。如果您已理解这一点，可跳过下一节。</p>
<h3 id="扩展-JUnit-4-的核心功能"><a href="#扩展-JUnit-4-的核心功能" class="headerlink" title="扩展 JUnit 4 的核心功能"></a>扩展 JUnit 4 的核心功能</h3><p>过去，希望扩展 JUnit 4 核心功能的开发人员或工具供应商会使用 <code>Runner</code> 和 <code>@Rule</code>。<br><em>Runner</em> 通常是 <code>BlockJUnit4ClassRunner</code> 的子类，用于提供 JUnit 中没有直接提供的某种行为。目前有许多第三方 <code>Runner</code>，比如用于运行基于 Spring 的单元测试的 <code>SpringJUnit4ClassRunner</code>，以及用于处理单元测试中 Mockito 对象的 <code>MockitoJUnitRunner</code>。<br>必须在测试类级别上使用 <code>@RunWith</code> 注解来声明 <code>Runner</code>。<code>@RunWith</code> 接受一个参数：<code>Runner</code> 的实现类。因为每个测试类最多只能拥有一个 <code>Runner</code>，所以每个测试类最多也只能拥有一个扩展点。<br>为了解决 <code>Runner</code> 概念的这一内置限制，JUnit 4.7 引入了 <code>@Rule</code>。一个测试类可声明多个 <code>@Rule</code>，这些规则可在测试方法级别和类级别上运行（而 <code>Runner</code> 只能在类级别上运行）。<br>鉴于 JUnit 4.7 的 <code>@Rule</code> 解决方法很好地处理了大部分情况，您可能想知道为什么我们还需要新的 JUnit Jupiter 扩展模型。下节将解释其中的原因。</p>
<h3 id="特性与扩展"><a href="#特性与扩展" class="headerlink" title="特性与扩展"></a>特性与扩展</h3><p>选择 JUnit 5 还是 JUnit Jupiter？<br>JUnit 5 和 JUnit Jupiter 之间的区别可能很容易让人混淆。提及 JUnit 5 时，我谈论的是 JUnit 的最新版本，其中包含一种新的 JUnit 方法和架构。而提及 JUnit Jupiter 时，我指的是用于编写测试的 API。</p>
<p>JUnit 5 的一个核心原则是[扩展点优于特性](<a href="https://github.com/junit-team/junit5/wiki/Core-Principles#prefer-" target="_blank" rel="noopener">https://github.com/junit-team/junit5/wiki/Core-Principles#prefer-</a> extension-points-over-features)。<br>这意味着尽管 JUnit <em>能</em>为工具供应商和开发人员提供各种特性，但 JUnit 5 团队更喜欢在架构中提供扩展点。这样第三方（无论是工具供应商、测试编写者还是其他任何人）就能在这些点上编写各种<em>扩展</em>。根据 JUnit Wiki 的解释，优先选择扩展点有 3 个原因：</p>
<ul>
<li>JUnit 不是，也不会尝试成为一个无所不包的实用程序。</li>
<li>第三方开发人员知道他们的需求，并且编写代码来满足自己需求的速度比 JUnit 团队响应某个特性请求的速度更快。</li>
<li>API 一旦发布，就<em>很难更改</em>。</li>
</ul>
<p>接下来我将解释如何扩展 JUnit Jupiter API，首先从扩展点开始。</p>
<h3 id="扩展点和测试生命周期"><a href="#扩展点和测试生命周期" class="headerlink" title="扩展点和测试生命周期"></a>扩展点和测试生命周期</h3><p>一个扩展点对应于 JUnit test 生命周期中一个预定义的点。从 Java™ 语言的角度讲，<em>扩展点</em>是您实现并向 JUnit 注册（激活）的回调接口。因此，<em>扩展点</em>是回调接口，<em>扩展</em>是该接口的实现。<br>在本教程中，我将把已实现的扩展点回调接口称为<em>扩展</em>。<br>一旦注册您的扩展，就会将其激活。在测试生命周期中合适的点上，JUnit 将使用回调接口调用它。<br>表 1 总结了 JUnit Jupiter 扩展模型中的扩展点。</p>
<p>表 1. 扩展点</p>
<table>
<thead>
<tr>
<th>接口</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>AfterAllCallback</td>
<td>定义 API 扩展，希望在调用所有测试后让测试容器执行额外的行为。</td>
</tr>
<tr>
<td>AfterEachCallback</td>
<td>定义 API 扩展，希望在调用每个测试方法后让测试执行额外的行为。</td>
</tr>
<tr>
<td>AfterTestExecutionCallback</td>
<td>定义 API 扩展，希望在执行每个测试后让测试立即执行额外的行为。</td>
</tr>
<tr>
<td>BeforeAllCallback</td>
<td>定义 API 扩展，希望在调用所有测试前让测试容器执行额外的行为。</td>
</tr>
<tr>
<td>BeforeEachCallback</td>
<td>定义 API 扩展，希望在调用每个测试前让测试执行额外的行为。</td>
</tr>
<tr>
<td>BeforeTestExecutionCallback</td>
<td>定义 API 扩展，希望在执行每个测试前让测试立即执行额外的行为。</td>
</tr>
<tr>
<td>ParameterResolver</td>
<td>定义 API 扩展，希望在运行时动态解析参数。</td>
</tr>
<tr>
<td>TestExecutionExceptionHandler</td>
<td>定义 API 扩展，希望处理在测试执行期间抛出的异常。</td>
</tr>
</tbody></table>
<p>表 1 中列出的扩展点回调接口已在示例应用程序的 <code>JUnit5ExtensionShowcase</code> 类中实现。可在 <code>com.makotojava.learn.junit5</code> 包中的 <code>test/src</code> 树中找到该类。</p>
<h3 id="创建扩展"><a href="#创建扩展" class="headerlink" title="创建扩展"></a>创建扩展</h3><p>要创建扩展，只需实现该扩展点的回调接口。假设我想创建一个在每个测试方法运行之前就运行的扩展。在此情况下，我只需要实现 <code>BeforeEachCallback</code> 接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeforeEachCallbackExtension</span> <span class="keyword">implements</span> <span class="title">BeforeEachCallback</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeEach</span><span class="params">(ExtensionContext context)</span> <span class="keyword">throws</span> Exception </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">// Implementation goes here</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>实现扩展点接口后，需要激活它，这样 JUnit 才能在测试生命周期中合适的点调用它。通过注册扩展来激活它。</p>
<h3 id="激活扩展"><a href="#激活扩展" class="headerlink" title="激活扩展"></a>激活扩展</h3><p>要激活上述扩展，只需使用 <code>@ExtendWith</code> 注解注册它：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ExtendWith</span>(MyBeforeEachCallbackExtension.class)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">public class MyTestClass &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    @<span class="selector-tag">Test</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">myTestMethod</span>() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">// Test code here</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="variable">@Test</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    public void someOtherTestMethod() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">// Test code here</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>当 <code>MyTestClass</code> 运行时，在执行每个 <code>@Test</code> 方法前，会调用 <code>MyBeforeEachCallbackExtension</code>。<br>注意，这种注册扩展的风格是<em>声明性的</em>。JUnit 还提供了一种自动注册机制，它使用了 Java 的 <code>ServiceLoader</code> 机制。此处不会详细介绍该机制，但 JUnit 5 用户指南的<a href="http://junit.org/junit5/docs/current/user-guide/#extensions-registration" target="_blank" rel="noopener">扩展模型</a>部分中提供了大量的有用信息。</p>
<h2 id="参数注入"><a href="#参数注入" class="headerlink" title="参数注入"></a>参数注入</h2><p>假设您想将一个参数传递给 <code>@Test</code> 方法。您如何完成该工作？下面我们就学习一下。</p>
<h3 id="ParameterResolver-接口"><a href="#ParameterResolver-接口" class="headerlink" title="ParameterResolver 接口"></a>ParameterResolver 接口</h3><p>如果所编写的测试方法在其签名中包含一个参数，则必须将该参数解析为一个实际对象，然后 JUnit 才能调用该方法。一种<em>乐观的场景</em>如下所示：JUnit (1) 寻找一个实现 <code>ParameterResolver</code> 接口的已注册扩展；(2) 调用它来解析该参数；(3) 然后调用您的测试方法，传入解析后的参数值。<br><code>ParameterResolver</code> 接口包含 2 个方法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">package</span> <span class="selector-tag">org</span><span class="selector-class">.junit</span><span class="selector-class">.jupiter</span><span class="selector-class">.api</span><span class="selector-class">.extension</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">static</span> <span class="selector-tag">org</span><span class="selector-class">.junit</span><span class="selector-class">.platform</span><span class="selector-class">.commons</span><span class="selector-class">.meta</span><span class="selector-class">.API</span><span class="selector-class">.Usage</span><span class="selector-class">.Experimental</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">java</span><span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Parameter</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">org</span><span class="selector-class">.junit</span><span class="selector-class">.platform</span><span class="selector-class">.commons</span><span class="selector-class">.meta</span><span class="selector-class">.API</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">@<span class="keyword">API</span>(<span class="keyword">Experimental</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> interface ParameterResolver extends Extension &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="selector-tag">boolean</span> <span class="selector-tag">supportsParameter</span>(<span class="selector-tag">ParameterContext</span> <span class="selector-tag">parameterContext</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">                              <span class="selector-tag">ExtensionContext</span> <span class="selector-tag">extensionContext</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">            <span class="selector-tag">throws</span> <span class="selector-tag">ParameterResolutionException</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="selector-tag">Object</span> <span class="selector-tag">resolveParameter</span>(<span class="selector-tag">ParameterContext</span> <span class="selector-tag">parameterContext</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">                            <span class="selector-tag">ExtensionContext</span> <span class="selector-tag">extensionContext</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            <span class="selector-tag">throws</span> <span class="selector-tag">ParameterResolutionException</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>Jupiter 测试引擎需要解析您的测试类中的一个参数时，它首先会调用 <code>supports()</code> 方法，查看该扩展是否能处理这种参数类型。如果 <code>supports()</code> 返回 <code>true</code>，则 Jupiter 测试引擎调用 <code>resolve()</code> 来获取正确类型的 <code>Object</code>，随后在调用测试方法时会使用该对象。<br>如果未找到能处理该参数类型的扩展，您会看到一条与下面类似的消息：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.junit</span><span class="selector-class">.jupiter</span><span class="selector-class">.api</span><span class="selector-class">.extension</span><span class="selector-class">.ParameterResolutionException</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">No ParameterResolver registered <span class="keyword">for</span> parameter [java<span class="selector-class">.lang</span><span class="selector-class">.String</span> arg0] <span class="keyword">in</span> executable</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">[public void com<span class="selector-class">.makotojava</span><span class="selector-class">.learn</span><span class="selector-class">.junit5</span>.PersonDaoBeanTest<span class="variable">$WhenDatabaseIsPopulated</span>.findAllByLastName(java<span class="selector-class">.lang</span>.String)].</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr></table></figure>

<h3 id="创建-ParameterResolver-实现"><a href="#创建-ParameterResolver-实现" class="headerlink" title="创建 ParameterResolver 实现"></a>创建 ParameterResolver 实现</h3><p>要创建一个 <code>ParameterResolver</code>，您只需实现该接口：</p>
<p>清单 3. Person 对象的 ParameterResolver 扩展点实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ExtensionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ParameterContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ParameterResolutionException;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ParameterResolver;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.makotojava.learn.junit.Person;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.makotojava.learn.junit.PersonGenerator;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratedPersonParameterResolver</span> <span class="keyword">implements</span> <span class="title">ParameterResolver</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Override</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsParameter</span><span class="params">(ParameterContext parameterContext, ExtensionContext extensionContext)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="function">      <span class="keyword">throws</span> ParameterResolutionException </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">return</span> parameterContext.getParameter().getType() == Person<span class="class">.<span class="keyword">class</span></span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Override</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">resolveParameter</span><span class="params">(ParameterContext parameterContext, ExtensionContext extensionContext)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="function">      <span class="keyword">throws</span> ParameterResolutionException </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">return</span> PersonGenerator.createPerson();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>在这个特定的用例中，如果参数的类型是 <code>Person</code>（第 14 行），则 <code>supports()</code> 返回 <code>true</code>。JUnit 需要将参数解析为 <code>Person</code> 对象时，它调用 <code>resolve()</code>，后者返回一个新生成的 <code>Person</code> 对象（第 20 行）。</p>
<h3 id="使用-ParameterResolver-实现"><a href="#使用-ParameterResolver-实现" class="headerlink" title="使用 ParameterResolver 实现"></a>使用 ParameterResolver 实现</h3><p>要使用 <code>ParameterResolver</code>，必须向 JUnit Jupiter 测试引擎注册它。与前面的演示一样，可使用 <code>@ExtendWith</code> 注解完成注册工作。</p>
<p>清单 4. 使用 ParameterResolver</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">DisplayName(<span class="string">"Testing PersonDaoBean"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ExtendWith(GeneratedPersonParameterResolver.<span class="params">class</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public <span class="keyword">class</span> PersonDaoBeanTest extends AbstractBaseTest &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    @Test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    @<span class="constructor">DisplayName(<span class="string">"Add generated Person should succeed - uses Parameter injection"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    public void add(Person person) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">      <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>, <span class="string">"PersonDaoBean reference cannot be null."</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">      Person personAdded = classUnderTest.add(person);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">      <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personAdded</span>, <span class="string">"Add failed but should have succeeded"</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">      <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personAdded</span>.<span class="params">getId</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">      perform<span class="constructor">PersonAssertions(<span class="params">person</span>.<span class="params">getLastName</span>()</span>, person.get<span class="constructor">FirstName()</span>, person.get<span class="constructor">Age()</span>, person.get<span class="constructor">EyeColor()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">          person.get<span class="constructor">Gender()</span>, personAdded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><code>PersonDaoBeanTest</code> 类运行时，它将向 Jupiter 测试引擎注册 <code>GeneratedPersonParameterResolver</code>。每次需要解析一个参数时，就会调用自定义 <code>ParameterResolver</code>。<br>扩展有一个影响范围 - 类级别或方法级别。<br>在这个特定的用例中，我选择在类级别注册扩展（第 2 行）。在类级别注册意味着，接受<em>任何</em>参数的任何测试方法都会导致 JUnit 调用 <code>GeneratedPersonParameterResolver</code> 扩展。如果参数类型为 <code>Person</code>，则返回一个已生成的 <code>Person</code> 对象并将其传递给测试方法（第 8 行）。<br>要将扩展的范围缩小到单个方法，可按如下方式注册扩展：</p>
<p>清单 5. 仅将 ParameterResolver 用于单个方法</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@Test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">DisplayName(<span class="string">"Add generated Person should succeed - uses Parameter injection"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ExtendWith(GeneratedPersonParameterResolver.<span class="params">class</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">public void add(Person person) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>, <span class="string">"PersonDaoBean reference cannot be null."</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    Person personAdded = classUnderTest.add(person);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personAdded</span>, <span class="string">"Add failed but should have succeeded"</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personAdded</span>.<span class="params">getId</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    perform<span class="constructor">PersonAssertions(<span class="params">person</span>.<span class="params">getLastName</span>()</span>, person.get<span class="constructor">FirstName()</span>, person.get<span class="constructor">Age()</span>, person.get<span class="constructor">EyeColor()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        person.get<span class="constructor">Gender()</span>, personAdded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>现在，系统只会调用该扩展来解析 <code>add()</code> 测试方法的参数。如果类中的任何其他测试方法需要参数解析，它们需要一个不同的 <code>ParameterResolver</code>。<br>注意，任何给定类的特定范围上只能有一个<code>ParameterResolver</code>。举例而言，如果您已经为在类级别上声明的 <code>Person</code> 对象提供了一个 <code>ParameterResolver</code>，并在同一个类中为在方法级别上声明的对象提供了另一个 <code>ParameterResolver</code>，那么 JUnit 就不知道使用哪一个。最终会看到以下消息来表明这种模糊性：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.junit</span><span class="selector-class">.jupiter</span><span class="selector-class">.api</span><span class="selector-class">.extension</span><span class="selector-class">.ParameterResolutionException</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">Discovered multiple competing ParameterResolvers <span class="keyword">for</span> parameter</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">[com<span class="selector-class">.makotojava</span><span class="selector-class">.learn</span><span class="selector-class">.junit</span><span class="selector-class">.Person</span> arg0] <span class="keyword">in</span> executable</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">[public void com<span class="selector-class">.makotojava</span><span class="selector-class">.learn</span><span class="selector-class">.junit5</span>.PersonDaoBeanTest<span class="variable">$WhenDatabaseIsPopulated</span>.update(com<span class="selector-class">.makotojava</span><span class="selector-class">.learn</span><span class="selector-class">.junit</span>.Person)]: .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr></table></figure>

<h3 id="准备看个视频来放松一下？"><a href="#准备看个视频来放松一下？" class="headerlink" title="准备看个视频来放松一下？"></a>准备看个视频来放松一下？</h3><p>下节将介绍参数化测试，但首先让我们用少许时间进行一些实践学习。下面的视频演示了如何在 JUnit 5 中使用 <code>ParameterResolver</code> 和 <code>@ParameterizedTest</code> 注解来测试基于 Spring 的应用程序。<br><strong>JUnit5 的高级特性</strong></p>
<p><a href="http://v.youku.com/v_show/id_XMjk1NTY4MTkxNg==.html" target="_blank" rel="noopener">点击查看视频演示</a></p>
<h2 id="参数化测试"><a href="#参数化测试" class="headerlink" title="参数化测试"></a>参数化测试</h2><p><em>参数化测试</em>是指多次调用 <code>@Test</code> 方法，但每次都使用不同的参数值。参数化测试必须使用 <code>@ParameterizedTest</code> 进行注解，而且必须为其参数指定一个<em>来源</em>。<br>JUnit Jupiter 提供了多个来源。每个来源指定一个 <code>@ArgumentsSource</code>，也就是一个 <code>ArgumentsProvider</code> 实现。本节将介绍如何使用 3 个来源：</p>
<ul>
<li><code>@ValueSource</code></li>
<li><code>@EnumSource</code></li>
<li><code>@MethodSource</code></li>
</ul>
<p>每个来源都在所允许的数据类型的易用性与灵活性之间进行了折中。最容易使用但最不灵活（仅限于一个 Java 原语子集）的是 <code>@ValueSource</code>。最灵活的是 <code>@MethodSource</code>，允许您使用所选的任何复杂对象来参数化测试方法。（注意，<code>@MethodSource</code> 也是最难使用的。）</p>
<h3 id="ValueSource"><a href="#ValueSource" class="headerlink" title="@ValueSource"></a>@ValueSource</h3><p>在 <code>@ValueSource</code> 中，您指定单个文字值数组，系统将这些文字值 — 一次一个地 — 提供给您的 <code>@ParameterizedTest</code> 方法。<br>语法类似于：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@ParameterizedTest</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ValueSource(<span class="params">longs</span> = &#123; 1L, 2L, 3L, 4L, 5L &#125;)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public void find<span class="constructor">ById(Long <span class="params">id</span>)</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Person personFound = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personFound</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">Equals(<span class="params">id</span>, <span class="params">personFound</span>.<span class="params">getId</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>首先您告诉 JUnit，<code>findById()</code> 方法是一个 <code>@ParameterizedTest</code>，如上面第 1 行所示。然后使用数组初始化器语法来指定数组，如第 2 行所示。JUnit 将调用 <code>findById()</code> 测试方法，每次将数组中的下一个 <code>long</code> 传递给该方法（第 3 行），直到用完数组。您可像任何 Java 方法参数一样使用该参数（第 5 行）。<br>作为数组名所提供的 <code>@ValueSource</code> 属性名必须全部采用小写，而且必须与其末尾有字母 <em>s</em> 的类型相匹配。例如，<code>ints</code> 与 <code>int</code> 数组匹配，<code>strings</code> 与 <code>String</code> 数组匹配，等等。<br>并不支持所有的原语类型，仅支持以下类型：</p>
<ul>
<li><code>String</code></li>
<li><code>int</code></li>
<li><code>long</code></li>
<li><code>double</code></li>
</ul>
<h3 id="EnumSource"><a href="#EnumSource" class="headerlink" title="@EnumSource"></a>@EnumSource</h3><p>在 <code>@EnumSource</code> 中，您指定一个 <code>enum</code>，JUnit — 一次一个地 — 将其中的值提供给 <code>@ParameterizedTest</code> 方法。<br>语法类似于：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@ParameterizedTest</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">EnumSource(PersonTestEnum.<span class="params">class</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public void find<span class="constructor">ById(PersonTestEnum <span class="params">testPerson</span>)</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Person person = testPerson.get<span class="constructor">Person()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    Person personFound = classUnderTest.find<span class="constructor">ById(<span class="params">person</span>.<span class="params">getId</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personFound</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    perform<span class="constructor">PersonAssertions(<span class="params">person</span>.<span class="params">getLastName</span>()</span>, person.get<span class="constructor">FirstName()</span>, person.get<span class="constructor">Age()</span>, person.get<span class="constructor">EyeColor()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        person.get<span class="constructor">Gender()</span>, personFound);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>首先您告诉 JUnit，<code>findById()</code> 方法是一个 <code>@ParameterizedTest</code>，如第 1 行所示。然后指定该 <code>enum</code> 的 Java 类，如第 2 行所示。JUnit 将调用 <code>findById()</code> 测试方法，每次将下一个 <code>enum</code> 值传递给该方法（第 3 行），直到用完该 <code>enum</code>。您可像任何 Java 方法参数一样使用该参数（第 5 行）。<br>注意，<code>PersonTestEnum</code> 类包含在本教程的配套示例应用程序中。它位于 <code>com.makotojava.learn.junit</code> 包中的 <code>src/test/java</code> 树中。</p>
<h3 id="MethodSource"><a href="#MethodSource" class="headerlink" title="@MethodSource"></a>@MethodSource</h3><p>使用注解 <code>@MethodSource</code>，可以指定您喜欢的任何复杂对象作为测试方法的参数类型。语法类似于：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@ParameterizedTest</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">MethodSource(<span class="params">value</span> = <span class="string">"personProvider"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public void find<span class="constructor">ById(Person <span class="params">paramPerson</span>)</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    long id = paramPerson.get<span class="constructor">Id()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    Person personFound = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personFound</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    perform<span class="constructor">PersonAssertions(<span class="params">paramPerson</span>.<span class="params">getLastName</span>()</span>, paramPerson.get<span class="constructor">FirstName()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        paramPerson.get<span class="constructor">Age()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        paramPerson.get<span class="constructor">EyeColor()</span>, paramPerson.get<span class="constructor">Gender()</span>, personFound);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><code>@MethodSource</code> 的 <code>names</code> 属性用于指定一个或多个方法名，这些方法为测试方法提供参数。一个方法来源的返回类型必须是 <code>Stream</code>、<code>Iterator</code>、<code>Iterable</code> 或数组。此外，提供者方法必须声明为 <code>static</code>，所以不能将它用在 <code>@Nested</code> 测试类内（至少截至 JUnit 5 Milestone 5 时不能这么做）。<br>在上面的示例中，<code>personProvider</code> 方法（来自示例应用程序）类似于：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">static Iterator&lt;Person&gt; person<span class="constructor">Provider()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    PersonTestEnum<span class="literal">[]</span> testPeople = <span class="module-access"><span class="module"><span class="identifier">PersonTestEnum</span>.</span></span>values<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    Person<span class="literal">[]</span> people = <span class="keyword">new</span> Person<span class="literal">[<span class="identifier">testPeople</span>.<span class="identifier">length</span>]</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    for (<span class="built_in">int</span> aa = <span class="number">0</span>; aa &lt; testPeople.length; aa++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">      people<span class="literal">[<span class="identifier">aa</span>]</span> = testPeople<span class="literal">[<span class="identifier">aa</span>]</span>.get<span class="constructor">Person()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Arrays</span>.</span></span><span class="keyword">as</span><span class="constructor">List(<span class="params">people</span>)</span>.iterator<span class="literal">()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>假设您想为测试方法添加一个额外的参数提供者。可以这样声明它：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@ParameterizedTest</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">MethodSource(<span class="params">value</span> = &#123; <span class="string">"personProvider"</span>, <span class="string">"additionalPersonProvider"</span> &#125;)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public void find<span class="constructor">ById(Person <span class="params">paramPerson</span>)</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    long id = paramPerson.get<span class="constructor">Id()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    Person personFound = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personFound</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    perform<span class="constructor">PersonAssertions(<span class="params">paramPerson</span>.<span class="params">getLastName</span>()</span>, paramPerson.get<span class="constructor">FirstName()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        paramPerson.get<span class="constructor">Age()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        paramPerson.get<span class="constructor">EyeColor()</span>, paramPerson.get<span class="constructor">Gender()</span>, personFound);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>我们使用数组初始化器语法指定这些方法（第 2 行），而且将按您指定的顺序调用各个方法，最后调用的是 <code>additionalPersonProvider()</code>。</p>
<h3 id="自定义显示名称"><a href="#自定义显示名称" class="headerlink" title="自定义显示名称"></a>自定义显示名称</h3><p>参数化测试的缺省显示名称包含测试索引（一个从 1 开始的迭代编号），以及该参数的 <code>String</code> 表示。如果测试类中有多个测试方法，那么输出容易让人混淆。幸运的是，可以通过向 <code>@ParameterizedTest</code> 注解提供任何以下属性值来自定义输出：</p>
<ul>
<li><em>{index}</em>：从 1 开始的索引（当前测试迭代 ）。</li>
<li><em>{arguments}</em>：完整的参数列表，使用逗号分隔。</li>
<li><em>{0}, {1} …</em>：一个特定的参数（0 是第一个，依此类推）。</li>
</ul>
<p>举例而言，假设提供了一个包含 5 个 <code>long</code> 的数组。在此情况下，可像这样注解 <code>@ParameterizedTest</code></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ParameterizedTest(<span class="params">name</span> = <span class="string">"@ValueSource: FindById(): Test# &#123;index&#125;: Id: &#123;0&#125;"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ValueSource(<span class="params">longs</span> = &#123; 1L, 2L, 3L, 4L, 5L &#125;)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">public void find<span class="constructor">ById(Long <span class="params">id</span>)</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">classUnderTest</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Person personFound = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">personFound</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">assert</span><span class="constructor">Equals(<span class="params">id</span>, <span class="params">personFound</span>.<span class="params">getId</span>()</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>将会生成以下输出：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ValueSource:</span> FindById(): Test# <span class="number">1</span>: <span class="attribute">Id</span>: <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ValueSource</span>: FindById(): Test# <span class="number">2</span>: <span class="attribute">Id</span>: <span class="number">2</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ValueSource</span>: FindById(): Test# <span class="number">3</span>: <span class="attribute">Id</span>: <span class="number">3</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ValueSource</span>: FindById(): Test# <span class="number">4</span>: <span class="attribute">Id</span>: <span class="number">4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@ValueSource</span>: FindById(): Test# <span class="number">5</span>: <span class="attribute">Id</span>: <span class="number">5</span></span></pre></td></tr></table></figure>

<h2 id="动态测试"><a href="#动态测试" class="headerlink" title="动态测试"></a>动态测试</h2><p>目前为止，我们分析的都是<em>静态测试</em>，这意味着测试代码、测试数据和测试的通过/失败条件在编译时都是已知的。<br>JUnit Jupiter 引入了一种称为<em>动态测试</em>的新测试类型，这种测试在运行时由一个称为<em>测试工厂</em>的特殊方法生成。</p>
<h3 id="TestFactory"><a href="#TestFactory" class="headerlink" title="@TestFactory"></a>@TestFactory</h3><p><code>@TestFactory</code> 方法用于生成动态测试。此方法必须返回 <code>DynamicTest</code> 实例的 <code>Stream</code>、<code>Collection</code>、<code>Iterable</code> 或 <code>Iterator</code>。<br>不同于 <code>@Test</code> 方法，<code>DynamicTest</code> 实例没有生命周期回调。所以 <code>@BeforeEach</code>、<code>@AfterEach</code> 和表 1 中的其他生命周期回调都不适用于 <code>DynamicTest</code>。</p>
<h3 id="创建-TestFactory"><a href="#创建-TestFactory" class="headerlink" title="创建 @TestFactory"></a>创建 @TestFactory</h3><p>考虑来自示例应用程序中 <code>PersonDaoBeanTest</code> 类的以下代码（可在 <code>com.makotojava.learn.junit5</code> 包的 <code>src/test/java</code> 树中找到它）：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@TestFactory</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">DisplayName(<span class="string">"FindById - Dynamic Test Generator"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">Stream&lt;DynamicTest&gt; generate<span class="constructor">FindByIdDynamicTests()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    Long<span class="literal">[]</span> ids = &#123; <span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>, <span class="number">4L</span>, <span class="number">5L</span> &#125;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span><span class="keyword">of</span>(ids).map(id -&gt; dynamic<span class="constructor">Test(<span class="string">"DynamicTest: Find by ID "</span> + <span class="params">id</span>, ()</span> -&gt; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        Person person = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">person</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">int</span> index = id.<span class="built_in">int</span><span class="constructor">Value()</span> - <span class="number">1</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        Person testPerson = <span class="module-access"><span class="module"><span class="identifier">PersonTestEnum</span>.</span></span>values<span class="literal">()</span><span class="literal">[<span class="identifier">index</span>]</span>.get<span class="constructor">Person()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        perform<span class="constructor">PersonAssertions(<span class="params">testPerson</span>.<span class="params">getLastName</span>()</span>, testPerson.get<span class="constructor">FirstName()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        testPerson.get<span class="constructor">Age()</span>, testPerson.get<span class="constructor">EyeColor()</span>, testPerson.get<span class="constructor">Gender()</span>, person);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    &#125;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><code>@TestFactory</code> 注解将此方法标记为一个 <code>DynamicTest</code> 工厂（第 1 行），并根据 JUnit Jupiter 的要求返回 <code>DynamicTest</code> 实例的一个 <code>Stream</code>（第 2 行）。该 <code>@TestFactory</code> 所生成的测试不会执行任何花哨的操作；它们仅在 <code>PersonDaoBean</code> Spring bean 上调用 <code>findById</code>（第 6 行），并执行一些断言（第 10 和 11 行）。但它展示了如何创建一个动态测试。</p>
<h2 id="标签和过滤"><a href="#标签和过滤" class="headerlink" title="标签和过滤"></a>标签和过滤</h2><p>标签对过滤测试很有用。在本节中，我将介绍如何创建一个自定义过滤器，然后将它转换为一个组合注解，用于控制哪些测试可运行。</p>
<h3 id="使用-Tags"><a href="#使用-Tags" class="headerlink" title="使用 @Tags"></a>使用 @Tags</h3><p>JUnit Jupiter <em>标签</em>描述 <code>@Tag</code> 注解的用法，该注解创建一个新的标识符（标签），并接受单个 <code>String</code> 参数来唯一地标识该标签。下面给出了一些示例：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@Tag</span>(<span class="string">"foo"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@Tag</span>(<span class="string">"bar"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="variable">@Tag</span>(<span class="string">"advanced"</span>)</span></pre></td></tr></table></figure>

<p>您可使用标签来注解方法或类，比如：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">Tag(<span class="string">"advanced"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@TestFactory</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">DisplayName(<span class="string">"FindById - Dynamic Test Generator"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Stream&lt;DynamicTest&gt; generate<span class="constructor">FindByIdDynamicTests()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Long<span class="literal">[]</span> ids = &#123; <span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>, <span class="number">4L</span>, <span class="number">5L</span>, <span class="number">6L</span> &#125;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span><span class="keyword">of</span>(ids).map(id -&gt; dynamic<span class="constructor">Test(<span class="string">"DynamicTest: Find by ID "</span> + <span class="params">id</span>, ()</span> -&gt; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        Person person = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">person</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">int</span> index = id.<span class="built_in">int</span><span class="constructor">Value()</span> - <span class="number">1</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        Person testPerson = <span class="module-access"><span class="module"><span class="identifier">PersonTestEnum</span>.</span></span>values<span class="literal">()</span><span class="literal">[<span class="identifier">index</span>]</span>.get<span class="constructor">Person()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        perform<span class="constructor">PersonAssertions(<span class="params">testPerson</span>.<span class="params">getLastName</span>()</span>, testPerson.get<span class="constructor">FirstName()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        testPerson.get<span class="constructor">Age()</span>, testPerson.get<span class="constructor">EyeColor()</span>, testPerson.get<span class="constructor">Gender()</span>, person);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    &#125;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>然后可使用 Maven POM 或 Gradle 构建脚本中的过滤器设置来过滤掉此测试。教程后面将介绍如何执行该操作。</p>
<h3 id="创建您自己的组合注解"><a href="#创建您自己的组合注解" class="headerlink" title="创建您自己的组合注解"></a>创建您自己的组合注解</h3><p>与使用 <code>@Tag</code> 和它的唯一名称相比， 使用<code>@Tag</code> 创建新的<em>组合注解</em>更重要。还记得上节中的 <code>@Tag(&quot;advanced&quot;)</code> 吗？我可以创建一个新的组合注解来表示一种高级测试类型，比如：</p>
<p>清单 6. 创建组合注解</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">import static java.lang.<span class="keyword">annotation</span>.<span class="title">ElementType</span>.<span class="title">METHOD</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">import static java.lang.<span class="keyword">annotation</span>.<span class="title">ElementType</span>.<span class="title">TYPE</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">import static java.lang.<span class="keyword">annotation</span>.<span class="title">RetentionPolicy</span>.<span class="title">RUNTIME</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">import java.lang.<span class="keyword">annotation</span>.<span class="title">Retention</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">import java.lang.<span class="keyword">annotation</span>.<span class="title">Target</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">import org.junit.jupiter.api.Tag;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">@Retention(RUNTIME)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">@Target(&#123; TYPE, METHOD &#125;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">@Tag(<span class="string">"advanced"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">public @interface Advanced &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    /<span class="regexp">/ Nothing to do</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="regexp">&#125;</span></span></pre></td></tr></table></figure>

<p>现在，我在所有使用 <code>@Tag(&quot;advanced&quot;)</code> 的地方都使用 <code>@Advanced</code> 来代替，如下所示：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">@Advanced</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">@TestFactory</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">@<span class="constructor">DisplayName(<span class="string">"FindById - Dynamic Test Generator"</span>)</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">Stream&lt;DynamicTest&gt; generate<span class="constructor">FindByIdDynamicTests()</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Long<span class="literal">[]</span> ids = &#123; <span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>, <span class="number">4L</span>, <span class="number">5L</span>, <span class="number">6L</span> &#125;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span><span class="keyword">of</span>(ids).map(id -&gt; dynamic<span class="constructor">Test(<span class="string">"DynamicTest: Find by ID "</span> + <span class="params">id</span>, ()</span> -&gt; &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        Person person = classUnderTest.find<span class="constructor">ById(<span class="params">id</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">assert</span><span class="constructor">NotNull(<span class="params">person</span>)</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        <span class="built_in">int</span> index = id.<span class="built_in">int</span><span class="constructor">Value()</span> - <span class="number">1</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        Person testPerson = <span class="module-access"><span class="module"><span class="identifier">PersonTestEnum</span>.</span></span>values<span class="literal">()</span><span class="literal">[<span class="identifier">index</span>]</span>.get<span class="constructor">Person()</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        perform<span class="constructor">PersonAssertions(<span class="params">testPerson</span>.<span class="params">getLastName</span>()</span>, testPerson.get<span class="constructor">FirstName()</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        testPerson.get<span class="constructor">Age()</span>, testPerson.get<span class="constructor">EyeColor()</span>, testPerson.get<span class="constructor">Gender()</span>, person);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    &#125;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>如前所述，您可在类级别或方法级别上使用新的组合注解（感谢 <code>@Target</code> 注解；参见清单 6 中的第 11 行）。可以查看示例应用程序中的 <code>PersonDaoBeanRepeatedTest</code> 类，看看这么做的实际效果，我在其中使用 <code>@Advanced</code> 注解了整个类。在 <code>PersonDaoBeanTest</code> 中，我只将生成动态测试的 <code>generateFindByIdDynamicTests()</code> 方法标记为 <code>@Advanced</code>。</p>
<h2 id="使用-Maven-运行"><a href="#使用-Maven-运行" class="headerlink" title="使用 Maven 运行"></a>使用 Maven 运行</h2><p>在第 1 部分中，我展示了如何使用 Maven 和 Gradle 运行 JUnit 测试。本节将展示如何配置 Maven POM，从示例应用程序中过滤掉 <code>@Advanced</code> 测试。<br>JUnit 用户指南包含各种 Maven 配置设置的[更详细参考指南](<a href="http://junit.org/junit5/docs/current/user-guide/#running-tests-" target="_blank" rel="noopener">http://junit.org/junit5/docs/current/user-guide/#running-tests-</a> build)，所以如果需要更多信息，推荐您查阅该指南。<br>要试用它，首先需要运行构建，并注意运行的测试数量（下面第 12 行）。您应看到类似下面这样的信息：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$ mvn clean test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="code"> T E S T S</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">May 22, 2017 10:04:15 AM org.junit.jupiter.engine.discovery.JavaElementsResolver resolveClass</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">Results :</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">Tests run: 92, Failures: 0, Errors: 0, Skipped: 0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">[INFO] BUILD SUCCESS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">[INFO] Total time: 55.276 s</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">[INFO] Finished at: 2017-05-22T10:05:08-05:00</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">[INFO] Final Memory: 19M/297M</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">$</span></pre></td></tr></table></figure>

<p>记住运行了多少个测试（第 12 行），这样才能将该数字与应用过滤器后的值进行比较。<br>在 Eclipse 中打开 POM，找到 Maven surefire 插件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span></pre></td></tr></table></figure>

<p>现在修改 <code>version</code> 元素（第 7 行）下的 POM，使它类似于：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">                <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">                    <span class="tag">&lt;<span class="name">excludeTags</span>&gt;</span>advanced<span class="tag">&lt;/<span class="name">excludeTags</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">                <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    .</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span></pre></td></tr></table></figure>

<p>再次运行构建内容，您应该看到运行的测试更少了。输出看起来应类似于：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">$mvn clean test</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="code"> T E S T S</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">May 22, 2017 10:09:42 AM org.junit.jupiter.engine.discovery.JavaElementsResolver resolveClass</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">Results :</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">Tests run: 47, Failures: 0, Errors: 0, Skipped: 0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">[INFO] BUILD SUCCESS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">[INFO] Total time: 32.023 s</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">[INFO] Finished at: 2017-05-22T10:10:11-05:00</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">[INFO] Final Memory: 20M/300M</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">[INFO] ------------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">$</span></pre></td></tr></table></figure>

<p>可以注意到，应用过滤后（第 12 行），运行的测试数量比以前少多了。</p>
<h2 id="使用-Gradle-运行"><a href="#使用-Gradle-运行" class="headerlink" title="使用 Gradle 运行"></a>使用 Gradle 运行</h2><p>接下来，我将展示如何配置 Gradle 构建脚本，从示例应用程序中过滤掉 <code>@Advanced</code> 测试。<br>JUnit 用户指南包含各种 Gradle 配置设置的<a href="http://junit.org/junit5/docs/current/user-guide/#running-tests-build" target="_blank" rel="noopener">更详细参考指南</a>，所以如果需要更多信息，推荐您查阅该指南。<br>要试用它，首先需要运行构建，并注意运行的测试数量（第 19、21 和 23 行）。您应看到类似下面这样的信息：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">gradle</span> <span class="string">clean</span> <span class="string">test</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">:clean</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">:compileJava</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">:processResources</span> <span class="literal">NO</span><span class="string">-SOURCE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">:classes</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">:compileTestJava</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">:processTestResources</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">:testClasses</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">:junitPlatformTest</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="string">.</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="string">.</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">Test</span> <span class="string">run</span> <span class="string">finished</span> <span class="string">after</span> <span class="number">62083</span> <span class="string">ms</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">24</span> <span class="string">containers</span> <span class="string">found</span>      <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">skipped</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">24</span> <span class="string">containers</span> <span class="string">started</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">aborted</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">24</span> <span class="string">containers</span> <span class="string">successful</span> <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">failed</span>     <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">92</span> <span class="string">tests</span> <span class="string">found</span>           <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">skipped</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">92</span> <span class="string">tests</span> <span class="string">started</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">aborted</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">92</span> <span class="string">tests</span> <span class="string">successful</span>      <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">failed</span>          <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="string">:test</span> <span class="string">SKIPPED</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="string">BUILD</span> <span class="string">SUCCESSFUL</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="attr">Total time:</span> <span class="number">1</span> <span class="string">mins</span> <span class="number">3.718</span> <span class="string">secs</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="string">$</span></span></pre></td></tr></table></figure>

<p>记住运行了多少个测试（第 23 行），这样才能将该数字与应用过滤器后的值进行比较。<br>在 Eclipse 中打开构建脚本并找到 <code>junitplatform</code> 节，该节类似于：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="section">junitPlatform</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="section">filters</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="section">engines</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="section">tags</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  <span class="attribute">logManager</span> <span class="string">'org.apache.logging.log4j.jul.LogManager'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>现在修改 <code>tags</code> 元素下的 POM，使它类似于：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="section">junitPlatform</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">  <span class="section">filters</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="section">engines</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="section">tags</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">        <span class="attribute">exclude</span> <span class="string">'advanced'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">  logManager <span class="string">'org.apache.logging.log4j.jul.LogManager'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>再次运行构建内容，您应该看到运行的测试更少了。输出看起来应类似于：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">gradle</span> <span class="string">clean</span> <span class="string">test</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="string">:clean</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="string">:compileJava</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="string">:processResources</span> <span class="literal">NO</span><span class="string">-SOURCE</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="string">:classes</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="string">:compileTestJava</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="string">:processTestResources</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="string">:testClasses</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="string">:junitPlatformTest</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="string">.</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="string">.</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="string">Test</span> <span class="string">run</span> <span class="string">finished</span> <span class="string">after</span> <span class="number">38834</span> <span class="string">ms</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">13</span> <span class="string">containers</span> <span class="string">found</span>      <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">skipped</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">13</span> <span class="string">containers</span> <span class="string">started</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">aborted</span>    <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">13</span> <span class="string">containers</span> <span class="string">successful</span> <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">containers</span> <span class="string">failed</span>     <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">47</span> <span class="string">tests</span> <span class="string">found</span>           <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">skipped</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">47</span> <span class="string">tests</span> <span class="string">started</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">aborted</span>         <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>        <span class="number">47</span> <span class="string">tests</span> <span class="string">successful</span>      <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="string">[</span>         <span class="number">0</span> <span class="string">tests</span> <span class="string">failed</span>          <span class="string">]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="string">:test</span> <span class="string">SKIPPED</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="string">BUILD</span> <span class="string">SUCCESSFUL</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="attr">Total time:</span> <span class="number">40.487</span> <span class="string">secs</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="string">$</span></span></pre></td></tr></table></figure>

<p>注意在应用过滤（第 19、21、23）后，运行的测试比以前少了多少。</p>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>JUnit 5 教程的后半部分重点介绍了 JUnit Vintage 和 JUnit Jupiter 扩展模型。JUnit Vintage 提供了与 JUnit 3 和 JUnit 4 的后向兼容性，JUnit Jupiter 扩展模型支持针对第三方工具或自定义测试场景来扩展 JUnit Jupiter API。我总结了 JUnit Jupiter 中提供的新扩展点，然后通过一系列示例重点展示了 JUnit 5 中针对参数注入、参数化测试、动态测试和自定义注解等新的可扩展特性。<br>恭喜您！您已学完 JUnit 5 教程。如果尚未观看本教程的配套<a href="https://www.youtube.com/watch?v=qzrMoCtEOkQ" target="_blank" rel="noopener">视频</a>，可以看一下。该视频详细介绍了您目前学到的有关新 <code>ParameterResolver</code> 和 <code>@ParameterizedTest</code> 特性的知识，还展示了如何运行 HelloJUnit5Part2 源代码中所包含的控制台启动器。</p>
<blockquote>
<p>作者：J Steven Perry</p>
<p>来源：<a href="https://www.ibm.com/developerworks/cn/java/j-introducing-junit5-part2-vintage-jupiter-extension-model/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/java/j-introducing-junit5-part2-vintage-jupiter-extension-model/index.html</a></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/JUnit/" rel="tag"># JUnit</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/12/26/Java-8-%E4%B9%A0%E6%83%AF%E7%94%A8%E8%AF%AD%EF%BC%8810%EF%BC%89%EF%BC%9A%E4%BD%BF%E7%94%A8%E9%97%AD%E5%8C%85%E6%8D%95%E8%8E%B7%E7%8A%B6%E6%80%81/" rel="prev" title="Java 8 习惯用语（10）：使用闭包捕获状态">
      <i class="fa fa-chevron-left"></i> Java 8 习惯用语（10）：使用闭包捕获状态
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/12/26/JUnit-5-%E7%AE%80%E4%BB%8B%EF%BC%9AJupiter-API/" rel="next" title="JUnit 5 简介：Jupiter API">
      JUnit 5 简介：Jupiter API <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前提条件"><span class="nav-number">1.</span> <span class="nav-text">前提条件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JUnit-Vintage"><span class="nav-number">2.</span> <span class="nav-text">JUnit Vintage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JUnit-3-中的测试"><span class="nav-number">2.1.</span> <span class="nav-text">JUnit 3 中的测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JUnit-4-中的测试"><span class="nav-number">2.2.</span> <span class="nav-text">JUnit 4 中的测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对迁移到-JUnit-Jupiter-的支持"><span class="nav-number">2.3.</span> <span class="nav-text">对迁移到 JUnit Jupiter 的支持</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JUnit-Jupiter-扩展模型"><span class="nav-number">3.</span> <span class="nav-text">JUnit Jupiter 扩展模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展-JUnit-4-的核心功能"><span class="nav-number">3.1.</span> <span class="nav-text">扩展 JUnit 4 的核心功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#特性与扩展"><span class="nav-number">3.2.</span> <span class="nav-text">特性与扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展点和测试生命周期"><span class="nav-number">3.3.</span> <span class="nav-text">扩展点和测试生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建扩展"><span class="nav-number">3.4.</span> <span class="nav-text">创建扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#激活扩展"><span class="nav-number">3.5.</span> <span class="nav-text">激活扩展</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参数注入"><span class="nav-number">4.</span> <span class="nav-text">参数注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ParameterResolver-接口"><span class="nav-number">4.1.</span> <span class="nav-text">ParameterResolver 接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建-ParameterResolver-实现"><span class="nav-number">4.2.</span> <span class="nav-text">创建 ParameterResolver 实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-ParameterResolver-实现"><span class="nav-number">4.3.</span> <span class="nav-text">使用 ParameterResolver 实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#准备看个视频来放松一下？"><span class="nav-number">4.4.</span> <span class="nav-text">准备看个视频来放松一下？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参数化测试"><span class="nav-number">5.</span> <span class="nav-text">参数化测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ValueSource"><span class="nav-number">5.1.</span> <span class="nav-text">@ValueSource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EnumSource"><span class="nav-number">5.2.</span> <span class="nav-text">@EnumSource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MethodSource"><span class="nav-number">5.3.</span> <span class="nav-text">@MethodSource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义显示名称"><span class="nav-number">5.4.</span> <span class="nav-text">自定义显示名称</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#动态测试"><span class="nav-number">6.</span> <span class="nav-text">动态测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TestFactory"><span class="nav-number">6.1.</span> <span class="nav-text">@TestFactory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建-TestFactory"><span class="nav-number">6.2.</span> <span class="nav-text">创建 @TestFactory</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标签和过滤"><span class="nav-number">7.</span> <span class="nav-text">标签和过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-Tags"><span class="nav-number">7.1.</span> <span class="nav-text">使用 @Tags</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建您自己的组合注解"><span class="nav-number">7.2.</span> <span class="nav-text">创建您自己的组合注解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-Maven-运行"><span class="nav-number">8.</span> <span class="nav-text">使用 Maven 运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用-Gradle-运行"><span class="nav-number">9.</span> <span class="nav-text">使用 Gradle 运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结束语"><span class="nav-number">10.</span> <span class="nav-text">结束语</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">congsheng.wang</p>
  <div class="site-description" itemprop="description">trouble is a friend</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">984</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">94</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">156</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">congsheng.wang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
